<!DOCTYPE html>

<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>REGERENT PRO</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300&display=swap" rel="stylesheet">
<style>
:root {
  --noir:#060608; --g1:#0E0E13; --g2:#14141B; --g3:#1A1A24; --g4:#22222E; --g5:#2C2C3A; --bord:#1E1E2A;
  --or:#C9A84C; --or2:#E8C97A; --or3:#F5E4B0; --blanc:#FFFFFF;
  --vert:#00E676; --vert2:#00BFA5; --jaune:#FFB300; --rouge:#FF3D3D; --bleu:#2979FF; --violet:#9C27B0;
  --txt:#6B6B80; --txt2:#9090A8; --txt3:#C0C0D0;
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{background:var(--noir);color:var(--blanc);font-family:'DM Sans',sans-serif;height:100%;overflow:hidden;font-size:14px}

/* ===== SCREENS ===== */
.screen{display:none;position:fixed;inset:0;flex-direction:column;background:var(â€“noir);z-index:10}
.screen.active{display:flex}

/* ===== AUTH ===== */
#s-auth{background:radial-gradient(ellipse 80% 50% at 50% -10%,rgba(201,168,76,.12),transparent);align-items:center;justify-content:center;padding:20px}
.auth-wrap{width:100%;max-width:400px}
.auth-logo{font-family:â€˜Bebas Neueâ€™;font-size:52px;letter-spacing:10px;text-align:center;background:linear-gradient(135deg,var(â€“or),var(â€“or3));-webkit-background-clip:text;-webkit-text-fill-color:transparent;line-height:1}
.auth-tagline{text-align:center;font-size:9px;letter-spacing:4px;color:var(â€“txt);margin-bottom:32px}
.mode-sel{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:24px}
.ms-btn{background:var(â€“g3);border:1px solid var(â€“bord);border-radius:14px;padding:14px 8px;text-align:center;cursor:pointer;transition:all .2s}
.ms-btn.active{background:rgba(201,168,76,.08);border-color:rgba(201,168,76,.4)}
.ms-ic{font-size:20px;margin-bottom:6px}
.ms-lbl{font-size:10px;font-weight:600;letter-spacing:1px;color:var(â€“txt2)}
.ms-btn.active .ms-lbl{color:var(â€“or2)}
.auth-card{background:var(â€“g2);border:1px solid var(â€“bord);border-radius:20px;padding:22px}
.atabs{display:flex;background:var(â€“g3);border-radius:10px;padding:3px;gap:3px;margin-bottom:18px}
.atab{flex:1;padding:9px;text-align:center;border-radius:7px;font-size:11px;font-weight:600;cursor:pointer;color:var(â€“txt);transition:all .2s;letter-spacing:.5px}
.atab.on{background:var(â€“or);color:var(â€“noir)}
.fl{font-size:8px;letter-spacing:1.5px;color:var(â€“txt);margin-bottom:4px;display:block;text-transform:uppercase}
.inp{background:var(â€“g3);border:1px solid var(â€“bord);border-radius:10px;padding:12px 14px;color:var(â€“blanc);font-family:â€˜DM Sansâ€™;font-size:13px;outline:none;width:100%;margin-bottom:9px;transition:border-color .2s}
.inp:focus{border-color:rgba(201,168,76,.5)}
.sel{background:var(â€“g3);border:1px solid var(â€“bord);border-radius:10px;padding:12px 14px;color:var(â€“blanc);font-family:â€˜DM Sansâ€™;font-size:13px;outline:none;width:100%;margin-bottom:9px;-webkit-appearance:none}
.r2{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.err{background:rgba(255,61,61,.06);border:1px solid rgba(255,61,61,.2);border-radius:8px;padding:8px 12px;font-size:11px;color:#FF8A80;display:none;margin-bottom:8px;text-align:center}
.btn-g{width:100%;background:linear-gradient(135deg,var(â€“or),var(â€“or2));color:var(â€“noir);border:none;border-radius:12px;padding:14px;font-family:â€˜Bebas Neueâ€™;font-size:18px;letter-spacing:2px;cursor:pointer;transition:opacity .2s;margin-top:4px}
.btn-g:active{opacity:.85}
.btn-ghost{width:100%;background:transparent;color:var(â€“txt2);border:1px solid var(â€“bord);border-radius:12px;padding:12px;font-family:â€˜DM Sansâ€™;font-size:12px;cursor:pointer;margin-top:7px}

/* ===== NAV ===== */
#nav{position:fixed;bottom:0;left:0;right:0;background:rgba(6,6,8,.97);backdrop-filter:blur(24px);border-top:1px solid var(â€“bord);display:none;padding:6px 0 env(safe-area-inset-bottom,16px);z-index:200}
.ntabs{display:flex}
.nt{flex:1;display:flex;flex-direction:column;align-items:center;gap:3px;cursor:pointer;padding:5px 3px;color:var(â€“txt);font-size:8px;font-weight:600;letter-spacing:.5px;transition:color .2s;text-transform:uppercase}
.nt.on{color:var(â€“or)}
.nt svg{width:19px;height:19px;stroke-width:1.6;transition:transform .2s}
.nt.on svg{transform:scale(1.1)}

/* ===== LAYOUT ===== */
.hdr{padding:48px 16px 10px;display:flex;align-items:center;justify-content:space-between;flex-shrink:0}
.logo{font-family:â€˜Bebas Neueâ€™;font-size:17px;letter-spacing:3px}
.logo span{color:var(â€“or)}
.scroll{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch;padding:0 14px 90px}
.scroll::-webkit-scrollbar{display:none}

/* ===== PILLS ===== */
.pill{font-size:8px;font-weight:700;padding:4px 9px;border-radius:20px;letter-spacing:1px;text-transform:uppercase}
.p-or{background:rgba(201,168,76,.1);color:var(â€“or);border:1px solid rgba(201,168,76,.2)}
.p-vt{background:rgba(0,230,118,.1);color:var(â€“vert);border:1px solid rgba(0,230,118,.2)}
.p-rg{background:rgba(255,61,61,.1);color:var(â€“rouge);border:1px solid rgba(255,61,61,.2)}
.p-bl{background:rgba(41,121,255,.1);color:var(â€“bleu);border:1px solid rgba(41,121,255,.2)}
.p-vl{background:rgba(156,39,176,.1);color:#CE93D8;border:1px solid rgba(156,39,176,.2)}

/* ===== CARDS ===== */
.card{background:var(â€“g2);border:1px solid var(â€“bord);border-radius:18px;padding:16px;margin-bottom:10px}
.card-dk{background:var(â€“g1);border:1px solid var(â€“bord);border-radius:18px;padding:16px;margin-bottom:10px}
.card-or{background:linear-gradient(135deg,rgba(201,168,76,.06),rgba(201,168,76,.02));border:1px solid rgba(201,168,76,.18);border-radius:18px;padding:16px;margin-bottom:10px}
.sec{font-family:â€˜Bebas Neueâ€™;font-size:11px;letter-spacing:2.5px;color:var(â€“txt);margin:16px 0 8px;text-transform:uppercase}

/* ===== RING PRINCIPAL ===== */
.ring-wrap{position:relative;width:170px;height:170px;margin:0 auto}
.ring-svg{transform:rotate(-90deg)}
.ring-center{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center}
.ring-val{font-family:â€˜Bebas Neueâ€™;font-size:52px;line-height:1}
.ring-lbl{font-size:8px;letter-spacing:2px;color:var(â€“txt);margin-top:2px}
.ring-st{font-size:11px;color:var(â€“txt2);margin-top:3px;font-style:italic}

/* ===== MINI RINGS ===== */
.mrings{display:flex;justify-content:space-around;margin-top:16px}
.mr{display:flex;flex-direction:column;align-items:center;gap:4px}
.mr-v{font-family:â€˜Bebas Neueâ€™;font-size:16px}
.mr-l{font-size:8px;color:var(â€“txt);letter-spacing:.5px}

/* ===== METRICS GRID ===== */
.mg{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.mi{background:var(â€“g3);border-radius:13px;padding:13px}
.mi-ic{font-size:15px;margin-bottom:4px}
.mi-v{font-family:â€˜Bebas Neueâ€™;font-size:22px;line-height:1;margin-top:3px}
.mi-l{font-size:8px;color:var(â€“txt);letter-spacing:.5px;margin-top:2px}
.mi-t{font-size:9px;font-weight:500;margin-top:3px}
.t-up{color:var(â€“vert)} .t-dn{color:var(â€“rouge)} .t-fl{color:var(â€“txt2)}

/* ===== CALENDRIER ===== */
.cal-hdr{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
.cal-nav{width:30px;height:30px;background:var(â€“g3);border-radius:8px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:14px;border:none;color:var(â€“blanc)}
.cal-title{font-family:â€˜Bebas Neueâ€™;font-size:14px;letter-spacing:2px;color:var(â€“or2)}
.cal-days-hdr{display:grid;grid-template-columns:repeat(7,1fr);margin-bottom:6px}
.cal-dh{text-align:center;font-size:8px;color:var(â€“txt);font-weight:600;letter-spacing:.5px;padding:4px 0}
.cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:3px}
.cal-day{aspect-ratio:1;border-radius:8px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:11px;font-weight:600;position:relative;transition:all .15s;border:1px solid transparent}
.cal-day.empty{background:transparent;cursor:default}
.cal-day.today{border-color:var(â€“or);color:var(â€“or)}
.cal-day.has-data{cursor:pointer}
.cal-day.has-data:hover{transform:scale(1.1)}
.cal-day.selected{border-color:var(â€“blanc);box-shadow:0 0 0 2px rgba(255,255,255,.3)}
.cal-day.no-data{color:var(â€“g5);background:var(â€“g2)}
.day-dot{position:absolute;bottom:3px;left:50%;transform:translateX(-50%);width:4px;height:4px;border-radius:50%}

/* ===== DAY DETAIL ===== */
.dd-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.7);z-index:300;align-items:flex-end}
.dd-overlay.show{display:flex}
.dd-sheet{background:var(â€“g2);border-radius:22px 22px 0 0;padding:20px 16px 32px;width:100%;max-height:80vh;overflow-y:auto;animation:slideUp .3s ease}
@keyframes slideUp{from{transform:translateY(100%)}to{transform:translateY(0)}}
.dd-handle{width:36px;height:3px;background:var(â€“g5);border-radius:3px;margin:0 auto 16px}
.dd-date{font-family:â€˜Bebas Neueâ€™;font-size:16px;letter-spacing:2px;color:var(â€“or2);margin-bottom:14px}
.dd-score{display:flex;align-items:center;gap:14px;margin-bottom:16px}
.dd-num{font-family:â€˜Bebas Neueâ€™;font-size:64px;line-height:1}
.dd-info{flex:1}
.dd-stat{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid var(â€“bord);font-size:12px}
.dd-stat:last-child{border-bottom:none}
.dd-stat-l{color:var(â€“txt2)}
.dd-stat-r{font-weight:600}

/* ===== BILAN ===== */
.q-prog{height:2px;background:var(â€“g3);border-radius:2px;overflow:hidden;flex-shrink:0}
.q-pfill{height:100%;background:linear-gradient(90deg,var(â€“or),var(â€“or2));transition:width .4s}
.q-step{display:none;flex-direction:column;gap:14px}
.q-step.active{display:flex}
.q-cat{font-size:8px;color:var(â€“or);letter-spacing:2.5px;font-weight:700;text-transform:uppercase}
.q-txt{font-size:17px;font-weight:500;line-height:1.4;color:var(â€“blanc)}
.slider-val{text-align:center;font-family:â€˜Bebas Neueâ€™;font-size:52px;color:var(â€“or);line-height:1}
input[type=range]{width:100%;-webkit-appearance:none;height:4px;border-radius:4px;background:var(â€“g4);outline:none}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:22px;height:22px;border-radius:50%;background:linear-gradient(135deg,var(â€“or),var(â€“or2));cursor:pointer;box-shadow:0 0 0 4px rgba(201,168,76,.15)}
.slbls{display:flex;justify-content:space-between;font-size:9px;color:var(â€“txt);margin-top:4px}
.chips{display:flex;flex-wrap:wrap;gap:6px}
.chip{background:var(â€“g3);border:1px solid var(â€“bord);border-radius:9px;padding:8px 12px;font-size:11px;color:var(â€“txt2);cursor:pointer;transition:all .15s;font-family:â€˜DM Sansâ€™}
.chip.on-r{background:rgba(255,61,61,.08);border-color:rgba(255,61,61,.3);color:#FF8A80}
.chip.on-g{background:rgba(201,168,76,.08);border-color:rgba(201,168,76,.3);color:var(â€“or2)}
.tap-opts{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
.tap-opt{background:var(â€“g3);border:1px solid var(â€“bord);border-radius:13px;padding:14px 8px;text-align:center;cursor:pointer;transition:all .2s}
.tap-opt .to-ic{font-size:22px;margin-bottom:5px}
.tap-opt .to-lbl{font-size:10px;color:var(â€“txt2);font-weight:500}
.tap-opt.sel{background:rgba(201,168,76,.08);border-color:rgba(201,168,76,.4)}
.tap-opt.sel .to-lbl{color:var(â€“or2)}
.q-nav{display:flex;gap:8px;margin-top:6px}
.btn-prev{flex:0 0 48px;background:var(â€“g3);border:1px solid var(â€“bord);border-radius:12px;color:var(â€“txt2);font-size:18px;cursor:pointer;display:flex;align-items:center;justify-content:center}
.btn-next{flex:1;background:linear-gradient(135deg,var(â€“or),var(â€“or2));color:var(â€“noir);border:none;border-radius:12px;padding:14px;font-family:â€˜Bebas Neueâ€™;font-size:17px;letter-spacing:1.5px;cursor:pointer}

/* ===== SUCCESS OVERLAY ===== */
#ovl{display:none;position:fixed;inset:0;background:var(â€“noir);z-index:500;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:40px}
#ovl.show{display:flex}
.ok-ring{width:88px;height:88px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:32px;margin-bottom:16px;animation:pop .5s cubic-bezier(.34,1.56,.64,1)}
@keyframes pop{0%{transform:scale(0);opacity:0}100%{transform:scale(1);opacity:1}}
.ok-score{font-family:â€˜Bebas Neueâ€™;font-size:92px;line-height:1;margin-bottom:4px}
.ok-verb{font-size:13px;color:var(â€“txt2);max-width:260px;line-height:1.7;margin-bottom:24px}
.proto-wrap{background:var(â€“g2);border:1px solid var(â€“bord);border-radius:16px;padding:16px;width:100%;max-width:320px;margin-bottom:20px;text-align:left}
.proto-ttl{font-family:â€˜Bebas Neueâ€™;font-size:11px;letter-spacing:2px;color:var(â€“or);margin-bottom:10px}
.proto-item{display:flex;gap:10px;padding:7px 0;border-bottom:1px solid var(â€“bord)}
.proto-item:last-child{border:none}
.pi-ic{font-size:14px;width:22px;flex-shrink:0}
.pi-t{font-size:11px;font-weight:600;color:var(â€“or2)}
.pi-d{font-size:10px;color:var(â€“txt2);margin-top:1px;line-height:1.5}

/* ===== SEANCE ===== */
.tog-row{background:var(â€“g3);border-radius:13px;padding:13px 15px;display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;cursor:pointer}
.tog-track{width:44px;height:24px;background:var(â€“g5);border-radius:12px;position:relative;transition:background .3s;flex-shrink:0}
.tog-track.on{background:var(â€“rouge)}
.tog-thumb{position:absolute;top:3px;left:3px;width:18px;height:18px;background:var(â€“blanc);border-radius:50%;transition:transform .3s;box-shadow:0 1px 4px rgba(0,0,0,.3)}
.tog-track.on .tog-thumb{transform:translateX(20px)}
.pulse{width:6px;height:6px;background:var(â€“rouge);border-radius:50%;animation:blink 1.4s infinite;flex-shrink:0}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.2}}
.pl-row{background:var(â€“g3);border-radius:12px;padding:10px 12px;margin-bottom:6px;display:flex;align-items:center;gap:10px}
.pl-av{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:â€˜Bebas Neueâ€™;font-size:11px;flex-shrink:0}
.pl-fc{font-family:â€˜Bebas Neueâ€™;font-size:21px;margin-left:auto}
.wbars{display:flex;align-items:flex-end;gap:4px;height:60px}
.wb-w{flex:1;display:flex;flex-direction:column;align-items:center;gap:2px}
.wb{width:100%;border-radius:3px;min-height:2px}

/* ===== CORPS ===== */
.htabs{display:flex;gap:6px;overflow-x:auto;margin-bottom:10px;padding-bottom:1px}
.htabs::-webkit-scrollbar{display:none}
.htab{flex-shrink:0;padding:7px 12px;border-radius:8px;font-size:10px;font-weight:600;cursor:pointer;color:var(â€“txt);background:var(â€“g3);border:1px solid transparent;transition:all .2s;letter-spacing:.5px}
.htab.on{background:rgba(201,168,76,.08);border-color:rgba(201,168,76,.3);color:var(â€“or)}
.bz-grid{display:grid;grid-template-columns:1fr 1fr;gap:5px}
.bz{padding:8px 10px;border-radius:9px;font-size:10px;font-weight:500;display:flex;align-items:center;gap:6px}
.bz-dot{width:5px;height:5px;border-radius:50%;flex-shrink:0}

/* ===== BENCHMARKS ===== */
.bk-item{background:var(â€“g3);border-radius:12px;padding:12px;margin-bottom:7px}
.bk-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.bk-lbl{font-size:11px;font-weight:600}
.bk-pct{font-family:â€˜Bebas Neueâ€™;font-size:18px}
.bk-bar{height:3px;background:var(â€“g5);border-radius:3px;overflow:hidden}
.bk-fill{height:100%;border-radius:3px;transition:width 1s ease}
.bk-desc{font-size:9px;color:var(â€“txt2);margin-top:5px}

/* ===== PASSEPORT ===== */
.pp-card{background:linear-gradient(135deg,rgba(201,168,76,.06),rgba(201,168,76,.02));border:1px solid rgba(201,168,76,.2);border-radius:18px;padding:18px;margin-bottom:10px}
.pp-hdr{display:flex;align-items:center;gap:10px;margin-bottom:14px}
.pp-badge{width:40px;height:40px;background:linear-gradient(135deg,var(â€“or),var(â€“or2));border-radius:11px;display:flex;align-items:center;justify-content:center;font-family:â€˜Bebas Neueâ€™;font-size:16px;color:var(â€“noir)}
.pp-ttl{font-family:â€˜Bebas Neueâ€™;font-size:13px;letter-spacing:2px;color:var(â€“or2)}
.pp-sub{font-size:9px;color:var(â€“txt2);margin-top:1px}
.pp-stats{display:grid;grid-template-columns:repeat(3,1fr);gap:6px;margin-bottom:12px}
.pp-s{background:var(â€“g3);border-radius:10px;padding:10px;text-align:center}
.pp-sv{font-family:â€˜Bebas Neueâ€™;font-size:22px;color:var(â€“or)}
.pp-sl{font-size:8px;color:var(â€“txt);margin-top:1px}
.pp-lock{display:flex;align-items:center;gap:8px;background:var(â€“g3);border-radius:10px;padding:10px 12px;font-size:11px;color:var(â€“txt2)}
.pp-lock-ic{font-size:14px}

/* ===== COACH IA ===== */
.c-wrap{display:flex;flex-direction:column;gap:8px}
.c-msg{padding:11px 13px;border-radius:13px;font-size:12px;line-height:1.65;max-width:88%}
.c-ai{background:var(â€“g3);border-radius:0 13px 13px 13px;align-self:flex-start}
.c-usr{background:rgba(201,168,76,.08);border:1px solid rgba(201,168,76,.18);border-radius:13px 0 13px 13px;align-self:flex-end;color:var(â€“or2)}
.c-inp-wrap{display:flex;gap:7px;margin-top:10px;position:sticky;bottom:0;background:var(â€“noir);padding:8px 0}
.c-inp{flex:1;background:var(â€“g3);border:1px solid var(â€“bord);border-radius:10px;padding:11px 13px;color:var(â€“blanc);font-size:12px;outline:none;font-family:â€˜DM Sansâ€™}
.c-inp:focus{border-color:rgba(201,168,76,.3)}
.c-send{background:var(â€“or);color:var(â€“noir);border:none;border-radius:10px;padding:11px 14px;font-family:â€˜Bebas Neueâ€™;font-size:13px;cursor:pointer;flex-shrink:0}
.c-typing{display:flex;align-items:center;gap:5px;padding:10px 13px;background:var(â€“g3);border-radius:0 13px 13px 13px;width:fit-content}
.c-dot{width:6px;height:6px;background:var(â€“txt);border-radius:50%;animation:tdot .8s infinite}
.c-dot:nth-child(2){animation-delay:.15s}
.c-dot:nth-child(3){animation-delay:.3s}
@keyframes tdot{0%,80%,100%{transform:scale(.8);opacity:.5}40%{transform:scale(1.1);opacity:1}}
.faq-item{background:var(â€“g2);border:1px solid var(â€“bord);border-radius:12px;padding:12px 14px;cursor:pointer;margin-bottom:6px;font-size:12px;display:flex;align-items:center;justify-content:space-between}
.faq-item:hover{border-color:rgba(201,168,76,.2);color:var(â€“or2)}

/* ===== PROFIL ===== */
.p-av{width:72px;height:72px;background:linear-gradient(135deg,var(â€“or),var(â€“or2));border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:â€˜Bebas Neueâ€™;font-size:26px;color:var(â€“noir);margin:0 auto 10px}
.eq-row{background:var(â€“g3);border-radius:11px;padding:11px 13px;margin-bottom:6px;display:flex;align-items:center;justify-content:space-between}
.eq-st{font-size:8px;padding:4px 9px;border-radius:20px;font-weight:600}
.eq-on{background:rgba(0,230,118,.1);color:var(â€“vert)}
.eq-off{background:var(â€“g5);color:var(â€“txt)}
.stat-row{display:flex;gap:1px;overflow:hidden;border-radius:10px}
.sb{flex:1;background:var(â€“g3);padding:10px 4px;text-align:center}
.sb-v{font-family:â€˜Bebas Neueâ€™;font-size:19px;color:var(â€“or)}
.sb-l{font-size:8px;color:var(â€“txt);margin-top:1px}

/* ===== AGENT MODE ===== */
.jou-card{background:var(â€“g2);border:1px solid var(â€“bord);border-radius:16px;padding:14px;margin-bottom:8px;display:flex;align-items:center;gap:12px;cursor:pointer;transition:border-color .2s}
.jou-card:hover{border-color:rgba(201,168,76,.2)}
.jou-av{width:42px;height:42px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:â€˜Bebas Neueâ€™;font-size:15px;flex-shrink:0;background:var(â€“g4)}
.jou-nm{font-size:13px;font-weight:600;margin-bottom:3px}
.jou-sb{font-size:10px;color:var(â€“txt2)}
.jou-sc{font-family:â€˜Bebas Neueâ€™;font-size:28px;margin-left:auto}
.rapport-btn{width:100%;background:linear-gradient(135deg,rgba(201,168,76,.1),rgba(201,168,76,.05));border:1px solid rgba(201,168,76,.3);border-radius:12px;padding:14px;color:var(â€“or2);font-family:â€˜Bebas Neueâ€™;font-size:15px;letter-spacing:1.5px;cursor:pointer;margin-bottom:8px;transition:all .2s}
.rapport-btn:hover{background:rgba(201,168,76,.12)}
.prix-sel{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:14px}
.prix-card{background:var(â€“g3);border:1px solid var(â€“bord);border-radius:13px;padding:12px;text-align:center;cursor:pointer;transition:all .2s}
.prix-card.on{background:rgba(201,168,76,.06);border-color:rgba(201,168,76,.4)}
.prix-ttl{font-family:â€˜Bebas Neueâ€™;font-size:12px;letter-spacing:1px;color:var(â€“txt2);margin-bottom:4px}
.prix-card.on .prix-ttl{color:var(â€“or2)}
.prix-val{font-family:â€˜Bebas Neueâ€™;font-size:24px;color:var(â€“or)}
.prix-dur{font-size:8px;color:var(â€“txt);margin-top:2px}

/* ===== STAFF MODE ===== */
.team-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:7px;margin-bottom:10px}
.tg-card{background:var(â€“g3);border-radius:13px;padding:12px;display:flex;flex-direction:column;align-items:center;gap:5px}
.tg-av{width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:â€˜Bebas Neueâ€™;font-size:12px}
.tg-nm{font-size:10px;font-weight:600;text-align:center}
.tg-sc{font-family:â€˜Bebas Neueâ€™;font-size:20px}
.charge-bar{height:8px;background:var(â€“g4);border-radius:4px;overflow:hidden;margin:6px 0}
.charge-fill{height:100%;border-radius:4px;transition:width .8s ease}
.alrt-card{background:rgba(255,61,61,.04);border:1px solid rgba(255,61,61,.2);border-radius:13px;padding:12px;margin-bottom:7px;display:flex;gap:10px}
.alrt-ic{width:28px;height:28px;background:rgba(255,61,61,.08);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:12px;flex-shrink:0}
.alrt-t{font-size:11px;font-weight:600;color:#FF8A80;margin-bottom:2px}
.alrt-d{font-size:10px;color:var(â€“txt2);line-height:1.5}

/* ===== MARKETPLACE ===== */
.mkt-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.mkt-card{background:var(â€“g2);border:1px solid var(â€“bord);border-radius:14px;padding:12px;cursor:pointer;transition:border-color .2s}
.mkt-card:hover{border-color:rgba(201,168,76,.2)}
.mkt-ic{font-size:24px;margin-bottom:8px}
.mkt-nm{font-size:12px;font-weight:600;margin-bottom:3px}
.mkt-br{font-size:10px;color:var(â€“txt2);margin-bottom:6px}
.mkt-p{font-family:â€˜Bebas Neueâ€™;font-size:18px;color:var(â€“or)}
.mkt-rec{font-size:8px;color:var(â€“vert);margin-top:3px}
.mkt-btn{width:100%;background:var(â€“g3);border:1px solid var(â€“bord);border-radius:8px;padding:8px;font-size:11px;font-weight:600;color:var(â€“txt2);cursor:pointer;margin-top:8px;font-family:â€˜DM Sansâ€™}

/* ===== TOAST ===== */
#toast{position:fixed;bottom:82px;left:50%;transform:translateX(-50%);background:var(â€“g3);color:var(â€“blanc);padding:9px 16px;border-radius:11px;font-size:11px;border:1px solid var(â€“bord);z-index:600;opacity:0;transition:opacity .3s;white-space:nowrap;pointer-events:none}
#toast.show{opacity:1}

/* ===== COMMUNITY ===== */
.rank-card{background:var(â€“g3);border-radius:12px;padding:12px 14px;margin-bottom:7px;display:flex;align-items:center;gap:12px}
.rank-num{font-family:â€˜Bebas Neueâ€™;font-size:22px;width:32px;text-align:center;color:var(â€“or)}
.rank-info{flex:1}
.rank-nm{font-size:12px;font-weight:600}
.rank-sb{font-size:9px;color:var(â€“txt2);margin-top:1px}
.rank-sc{font-family:â€˜Bebas Neueâ€™;font-size:24px}

/* ===== RESPONSIVE WEB ===== */
@media(min-width:768px){
body{overflow:auto}
.screen{position:relative;min-height:100vh;overflow:auto}
.screen.active{display:flex}
#nav{max-width:480px;left:50%;transform:translateX(-50%);border-radius:14px 14px 0 0}
.scroll{max-width:480px;margin:0 auto;width:100%}
.hdr{max-width:480px;margin:0 auto;width:100%}
#s-auth{min-height:100vh}
.auth-wrap{max-width:440px}
}
@media(min-width:1024px){
#nav{max-width:540px}
.scroll{max-width:540px}
.hdr{max-width:540px}
}
</style>

</head>
<body>

<!-- AUTH -->

<div class="screen active" id="s-auth">
  <div class="auth-wrap">
    <div class="auth-logo">REGERENT</div>
    <div class="auth-tagline">PRO Â· PLATEFORME RÃ‰CUPÃ‰RATION FOOTBALL</div>
    <div class="mode-sel">
      <div class="ms-btn active" id="ms-j" onclick="selMode('joueur')"><div class="ms-ic">âš½</div><div class="ms-lbl">JOUEUR</div></div>
      <div class="ms-btn" id="ms-a" onclick="selMode('agent')"><div class="ms-ic">ğŸ¤</div><div class="ms-lbl">AGENT</div></div>
      <div class="ms-btn" id="ms-s" onclick="selMode('staff')"><div class="ms-ic">ğŸ“Š</div><div class="ms-lbl">STAFF</div></div>
    </div>
    <div class="auth-card">
      <div class="atabs"><div class="atab on" id="tL" onclick="aTab('l')">CONNEXION</div><div class="atab" id="tR" onclick="aTab('r')">INSCRIPTION</div></div>
      <div id="fL">
        <label class="fl">Email</label><input class="inp" type="email" id="lE" placeholder="ton@email.com">
        <label class="fl">Mot de passe</label><input class="inp" type="password" id="lP" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
        <div class="err" id="lErr"></div>
        <button class="btn-g" onclick="doLogin()">CONNEXION</button>
        <button class="btn-ghost" onclick="demo()">Explorer en mode dÃ©mo</button>
      </div>
      <div id="fR" style="display:none">
        <div class="r2"><div><label class="fl">PrÃ©nom</label><input class="inp" type="text" id="rPr" placeholder="Kofi"></div><div><label class="fl">Nom</label><input class="inp" type="text" id="rNo" placeholder="Diallo"></div></div>
        <label class="fl">Email</label><input class="inp" type="email" id="rE" placeholder="ton@email.com">
        <label class="fl">Mot de passe</label><input class="inp" type="password" id="rP" placeholder="min. 8 caractÃ¨res">
        <div id="j-fields">
          <label class="fl">Position</label>
          <select class="sel" id="rPos"><option value="">SÃ©lectionner</option><option>Gardien</option><option>DÃ©fenseur central</option><option>LatÃ©ral droit</option><option>LatÃ©ral gauche</option><option>Milieu dÃ©fensif</option><option>Milieu central</option><option>Milieu offensif</option><option>Ailier droit</option><option>Ailier gauche</option><option>Avant-centre</option></select>
        </div>
        <label class="fl">Club</label><input class="inp" type="text" id="rCl" placeholder="Nom du club">
        <div class="err" id="rErr"></div>
        <button class="btn-g" onclick="doRegister()">CRÃ‰ER MON COMPTE</button>
      </div>
    </div>
  </div>
</div>

<!-- SUCCESS OVERLAY -->

<div id="ovl">
  <div class="ok-ring" id="okRing"></div>
  <div style="font-family:'Bebas Neue';font-size:24px;letter-spacing:3px;margin-bottom:4px">SCORE DU JOUR</div>
  <div class="ok-score" id="okScore"></div>
  <div class="ok-verb" id="okVerb"></div>
  <div class="proto-wrap" id="protoOvl"></div>
  <button class="btn-g" style="max-width:240px" onclick="closeOvl()">VOIR MON DASHBOARD</button>
</div>

<!-- DAY DETAIL -->

<div class="dd-overlay" id="ddOverlay" onclick="closeDd(event)">
  <div class="dd-sheet" id="ddSheet">
    <div class="dd-handle"></div>
    <div class="dd-date" id="ddDate"></div>
    <div class="dd-score">
      <div class="dd-num" id="ddScore"></div>
      <div class="dd-info"><div id="ddPill"></div><div style="font-size:11px;color:var(--txt2);margin-top:5px" id="ddVerb"></div></div>
    </div>
    <div id="ddStats"></div>
  </div>
</div>

<div id="toast"></div>

<!-- ========== JOUEUR SCREENS ========== -->

<!-- HOME JOUEUR -->

<div class="screen" id="s-home">
  <div class="hdr"><div><div id="greet" style="font-size:8px;letter-spacing:2px;color:var(--txt);margin-bottom:2px">BON MATIN</div><div class="logo">REGE<span>RENT</span> PRO</div></div><div id="hPill" class="pill p-or">JOUEUR</div></div>
  <div class="scroll">
    <!-- RING -->
    <div class="card" style="text-align:center;padding:20px 16px">
      <div style="font-size:8px;letter-spacing:2.5px;color:var(--txt);margin-bottom:12px">REGERENT SCORE</div>
      <div class="ring-wrap">
        <svg class="ring-svg" width="170" height="170" viewBox="0 0 170 170">
          <circle fill="none" stroke="var(--g3)" stroke-width="11" cx="85" cy="85" r="72"/>
          <circle id="rFg" fill="none" stroke="var(--or)" stroke-width="11" stroke-linecap="round" cx="85" cy="85" r="72" stroke-dasharray="452" stroke-dashoffset="452" style="transition:stroke-dashoffset 1.2s cubic-bezier(.4,0,.2,1)"/>
        </svg>
        <div class="ring-center">
          <div class="ring-val" id="rVal" style="color:var(--or)">--</div>
          <div class="ring-lbl">SCORE</div>
          <div class="ring-st" id="rSt"></div>
        </div>
      </div>
      <div class="mrings">
        <div class="mr"><svg width="52" height="52" viewBox="0 0 52 52" style="transform:rotate(-90deg)"><circle fill="none" stroke="var(--g3)" stroke-width="5" cx="26" cy="26" r="20"/><circle id="m1" fill="none" stroke="var(--vert2)" stroke-width="5" stroke-linecap="round" cx="26" cy="26" r="20" stroke-dasharray="125.6" stroke-dashoffset="125.6" style="transition:stroke-dashoffset 1s ease"/></svg><div class="mr-v" id="mv1" style="color:var(--vert2)">--</div><div class="mr-l">SOMMEIL</div></div>
        <div class="mr"><svg width="52" height="52" viewBox="0 0 52 52" style="transform:rotate(-90deg)"><circle fill="none" stroke="var(--g3)" stroke-width="5" cx="26" cy="26" r="20"/><circle id="m2" fill="none" stroke="var(--or)" stroke-width="5" stroke-linecap="round" cx="26" cy="26" r="20" stroke-dasharray="125.6" stroke-dashoffset="125.6" style="transition:stroke-dashoffset 1s ease"/></svg><div class="mr-v" id="mv2" style="color:var(--or)">--</div><div class="mr-l">CORPS</div></div>
        <div class="mr"><svg width="52" height="52" viewBox="0 0 52 52" style="transform:rotate(-90deg)"><circle fill="none" stroke="var(--g3)" stroke-width="5" cx="26" cy="26" r="20"/><circle id="m3" fill="none" stroke="#CE93D8" stroke-width="5" stroke-linecap="round" cx="26" cy="26" r="20" stroke-dasharray="125.6" stroke-dashoffset="125.6" style="transition:stroke-dashoffset 1s ease"/></svg><div class="mr-v" id="mv3" style="color:#CE93D8">--</div><div class="mr-l">MENTAL</div></div>
      </div>
    </div>
    <div id="homeAlrt"></div>
    <!-- BILAN CTA -->
    <div id="bilanCTA" class="card">
      <div style="font-size:10px;color:var(--txt);margin-bottom:4px">Bilan du jour en attente</div>
      <div style="font-size:15px;font-weight:600;margin-bottom:12px">1 tap pour calculer ton score</div>
      <button class="btn-g" onclick="goTo('s-bilan')">BILAN DU MATIN</button>
    </div>
    <!-- METRICS -->
    <div class="sec">DONNÃ‰ES DU JOUR</div>
    <div class="mg">
      <div class="mi"><div class="mi-ic">ğŸŒ™</div><div class="mi-v" id="mS">--</div><div class="mi-l">SOMMEIL</div><div class="mi-t" id="mST"></div></div>
      <div class="mi"><div class="mi-ic">ğŸ’“</div><div class="mi-v" id="mH">--</div><div class="mi-l">HRV</div><div class="mi-t" id="mHT"></div></div>
      <div class="mi"><div class="mi-ic">ğŸƒ</div><div class="mi-v" id="mP">--</div><div class="mi-l">PHYSIQUE</div></div>
      <div class="mi"><div class="mi-ic">ğŸ§ </div><div class="mi-v" id="mM">--</div><div class="mi-l">MENTAL</div></div>
    </div>
    <!-- PROTOCOLE -->
    <div id="protoHome" class="card-or" style="display:none">
      <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px"><div style="font-size:18px">âš¡</div><div style="font-family:'Bebas Neue';font-size:11px;letter-spacing:2px;color:var(--or2)">PROTOCOLE CE SOIR</div></div>
      <div id="protoHomeSteps"></div>
    </div>
    <!-- COURBE -->
    <div class="sec">7 DERNIERS JOURS</div>
    <div class="card-dk">
      <div class="wbars" id="wbars7"></div>
      <div style="display:flex;justify-content:space-between;font-size:8px;color:var(--txt);padding:4px 2px 0"><span>L</span><span>M</span><span>M</span><span>J</span><span>V</span><span>S</span><span>D</span></div>
    </div>
    <!-- HABITUDES -->
    <div class="sec">IMPACT HABITUDES Â· 30J</div>
    <div class="card" id="bhvCard"></div>
    <div style="margin-bottom:14px"><button style="background:transparent;color:var(--txt);border:1px solid var(--bord);border-radius:9px;padding:8px 14px;font-size:11px;cursor:pointer;font-family:'DM Sans'" onclick="doLogout()">DÃ©connexion</button></div>
  </div>
</div>

<!-- BILAN MATINAL -->

<div class="screen" id="s-bilan">
  <div class="hdr" style="padding-bottom:6px">
    <div style="cursor:pointer;color:var(--txt2);font-size:13px" onclick="goTo('s-home')">â† Retour</div>
    <div style="font-family:'Bebas Neue';font-size:13px;letter-spacing:2px">BILAN MATINAL</div>
    <div style="font-size:9px;color:var(--txt)" id="qPct">0/5</div>
  </div>
  <div class="q-prog"><div class="q-pfill" id="qFill" style="width:0%"></div></div>
  <div class="scroll" style="padding-top:16px">
    <!-- STEP 1 : TAP RESSENTI -->
    <div class="q-step active" id="qs1">
      <div class="q-cat">RESSENTI GLOBAL</div>
      <div class="q-txt">Comment tu te rÃ©veilles ce matin ?</div>
      <div class="tap-opts">
        <div class="tap-opt" onclick="selTap(0,this)" data-v="1"><div class="to-ic">ğŸ˜´</div><div class="to-lbl">Ã‰puisÃ©</div></div>
        <div class="tap-opt" onclick="selTap(0,this)" data-v="4"><div class="to-ic">ğŸ˜</div><div class="to-lbl">Correct</div></div>
        <div class="tap-opt" onclick="selTap(0,this)" data-v="7"><div class="to-ic">âš¡</div><div class="to-lbl">En forme</div></div>
        <div class="tap-opt" onclick="selTap(0,this)" data-v="10"><div class="to-ic">ğŸ”¥</div><div class="to-lbl">Au top</div></div>
      </div>
      <div class="q-nav"><button class="btn-next" onclick="qNext(1)">SUIVANT â†’</button></div>
    </div>
    <!-- STEP 2 : SOMMEIL -->
    <div class="q-step" id="qs2">
      <div class="q-cat">SOMMEIL</div>
      <div class="q-txt">Combien d'heures tu as dormi ?</div>
      <div class="slider-val" id="sv2">7.0h</div>
      <input type="range" min="4" max="11" value="7" step="0.5" id="r2" oninput="sv2.textContent=this.value+'h'">
      <div class="slbls"><span>4h</span><span>Optimal 8h+</span><span>11h</span></div>
      <div class="q-nav"><button class="btn-prev" onclick="qBack(1)">â†</button><button class="btn-next" onclick="qNext(2)">SUIVANT â†’</button></div>
    </div>
    <!-- STEP 3 : DOULEUR -->
    <div class="q-step" id="qs3">
      <div class="q-cat">CORPS Â· DOULEUR</div>
      <div class="q-txt">Une gÃªne ou douleur ce matin ?</div>
      <div class="chips" id="painC">
        <div class="chip" onclick="tPain(this)">Aucune</div>
        <div class="chip" onclick="tPain(this)">Dos</div>
        <div class="chip" onclick="tPain(this)">Genou G</div>
        <div class="chip" onclick="tPain(this)">Genou D</div>
        <div class="chip" onclick="tPain(this)">Ischio G</div>
        <div class="chip" onclick="tPain(this)">Ischio D</div>
        <div class="chip" onclick="tPain(this)">Cheville G</div>
        <div class="chip" onclick="tPain(this)">Cheville D</div>
        <div class="chip" onclick="tPain(this)">Cuisse G</div>
        <div class="chip" onclick="tPain(this)">Cuisse D</div>
      </div>
      <div class="q-nav"><button class="btn-prev" onclick="qBack(2)">â†</button><button class="btn-next" onclick="qNext(3)">SUIVANT â†’</button></div>
    </div>
    <!-- STEP 4 : EQUIP -->
    <div class="q-step" id="qs4">
      <div class="q-cat">RÃ‰CUPÃ‰RATION HIER</div>
      <div class="q-txt">Qu'as-tu utilisÃ© hier soir ?</div>
      <div class="chips" id="equipC">
        <div class="chip" onclick="tEquip(this)" data-v="OXY_ONE">ğŸ« OXY ONE</div>
        <div class="chip" onclick="tEquip(this)" data-v="CRYO_ONE">ğŸ§Š CRYO ONE</div>
        <div class="chip" onclick="tEquip(this)" data-v="PRESSO_ONE">ğŸ’¨ PRESSO ONE</div>
        <div class="chip" onclick="tEquip(this)" data-v="BAND">âŒš BAND nuit</div>
        <div class="chip" onclick="tEquip(this)" data-v="rien">Rien</div>
      </div>
      <div class="q-nav"><button class="btn-prev" onclick="qBack(3)">â†</button><button class="btn-next" onclick="qNext(4)">SUIVANT â†’</button></div>
    </div>
    <!-- STEP 5 : MENTAL -->
    <div class="q-step" id="qs5">
      <div class="q-cat">MENTAL</div>
      <div class="q-txt">Comment tu te sens mentalement ?</div>
      <div class="slider-val" id="sv5">7</div>
      <input type="range" min="1" max="10" value="7" id="r5" oninput="sv5.textContent=this.value">
      <div class="slbls"><span>Ã€ plat</span><span>En feu</span></div>
      <div class="q-nav"><button class="btn-prev" onclick="qBack(4)">â†</button><button class="btn-next" onclick="submitBilan()">CALCULER MON SCORE âš¡</button></div>
    </div>
  </div>
</div>

<!-- CALENDRIER HISTORIQUE -->

<div class="screen" id="s-cal">
  <div class="hdr"><div class="logo">REGE<span>RENT</span> PRO</div><div class="pill p-or">HISTORIQUE</div></div>
  <div class="scroll">
    <div class="card">
      <div class="cal-hdr">
        <button class="cal-nav" onclick="calNav(-1)">â€¹</button>
        <div class="cal-title" id="calTitle"></div>
        <button class="cal-nav" onclick="calNav(1)">â€º</button>
      </div>
      <div class="cal-days-hdr"><div class="cal-dh">L</div><div class="cal-dh">M</div><div class="cal-dh">M</div><div class="cal-dh">J</div><div class="cal-dh">V</div><div class="cal-dh">S</div><div class="cal-dh">D</div></div>
      <div class="cal-grid" id="calGrid"></div>
    </div>
    <div class="sec">RÃ‰SUMÃ‰ DU MOIS</div>
    <div class="mg" id="calStats">
      <div class="mi"><div class="mi-ic">ğŸ“Š</div><div class="mi-v" id="csSm">--</div><div class="mi-l">SCORE MOY.</div></div>
      <div class="mi"><div class="mi-ic">ğŸ”¥</div><div class="mi-v" id="csStr">--</div><div class="mi-l">STREAK</div></div>
      <div class="mi"><div class="mi-ic">âœ…</div><div class="mi-v" id="csBil">--</div><div class="mi-l">BILANS</div></div>
      <div class="mi"><div class="mi-ic">ğŸ’ª</div><div class="mi-v" id="csDis">--%</div><div class="mi-l">DISPO</div></div>
    </div>
    <div class="sec">PROGRESSION</div>
    <div class="card-dk" style="padding:16px">
      <div class="wbars" id="calProg" style="height:70px"></div>
      <div style="font-size:9px;color:var(--txt);margin-top:6px">Scores des 30 derniers jours</div>
    </div>
  </div>
</div>

<!-- SÃ‰ANCE -->

<div class="screen" id="s-seance">
  <div class="hdr"><div class="logo">REGE<span>RENT</span> PRO</div><div id="sPill" class="pill p-or">HORS SÃ‰ANCE</div></div>
  <div class="scroll">
    <div class="tog-row" onclick="toggleSeance()">
      <div><div style="font-weight:600;font-size:13px" id="togT">Activer le mode sÃ©ance</div><div style="font-size:10px;color:var(--txt2);margin-top:2px" id="togS">Surveillance temps rÃ©el</div></div>
      <div class="tog-track" id="togTr"><div class="tog-thumb"></div></div>
    </div>
    <div id="hs">
      <div class="sec">CHARGE DE LA SEMAINE</div>
      <div class="card-dk">
        <div style="display:flex;justify-content:space-around;margin-bottom:10px">
          <div style="text-align:center"><div style="font-family:'Bebas Neue';font-size:26px;color:var(--or)">342</div><div style="font-size:8px;color:var(--txt)">CHARGE</div></div>
          <div style="text-align:center"><div style="font-family:'Bebas Neue';font-size:26px;color:var(--vert)">+8%</div><div style="font-size:8px;color:var(--txt)">VS PRÃ‰C.</div></div>
          <div style="text-align:center"><div style="font-family:'Bebas Neue';font-size:26px;color:var(--jaune)">3/5</div><div style="font-size:8px;color:var(--txt)">SÃ‰ANCES</div></div>
        </div>
        <div class="charge-bar"><div class="charge-fill" style="width:65%;background:linear-gradient(90deg,var(--vert),var(--jaune))"></div></div>
        <div style="display:flex;justify-content:space-between;font-size:8px;color:var(--txt)"><span>Zone optimale</span><span>65%</span></div>
      </div>
      <div class="sec">DERNIÃˆRE SÃ‰ANCE</div>
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px"><div><div style="font-weight:600">EntraÃ®nement collectif</div><div style="font-size:10px;color:var(--txt2);margin-top:2px">Hier Â· 1h45</div></div><div class="pill p-or">INTENSE</div></div>
        <div class="stat-row"><div class="sb"><div class="sb-v">162</div><div class="sb-l">FC MOY.</div></div><div class="sb"><div class="sb-v">186</div><div class="sb-l">FC MAX.</div></div><div class="sb"><div class="sb-v">78%</div><div class="sb-l">ZONE 3+</div></div><div class="sb"><div class="sb-v">847</div><div class="sb-l">KCAL</div></div></div>
      </div>
    </div>
    <div id="es" style="display:none">
      <div class="card" style="background:rgba(255,61,61,.04);border-color:rgba(255,61,61,.2)">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px">
          <div><div style="display:flex;align-items:center;gap:7px;margin-bottom:3px"><div class="pulse"></div><div style="font-size:8px;letter-spacing:2px;color:var(--rouge)">EN COURS</div></div><div style="font-family:'Bebas Neue';font-size:36px;color:var(--rouge)" id="sTimer">00:00</div></div>
          <div style="text-align:right"><div style="font-family:'Bebas Neue';font-size:36px" id="fcG">--</div><div style="font-size:8px;color:var(--txt)">FC Ã‰QUIPE MOY.</div></div>
        </div>
        <div class="charge-bar"><div id="zBar" style="height:100%;width:50%;background:linear-gradient(90deg,var(--vert),var(--jaune));border-radius:4px;transition:width .5s"></div></div>
        <div style="display:flex;justify-content:space-between;font-size:8px;color:var(--txt);margin-top:3px"><span>Zone 1-2</span><span id="zLbl">Zone 3</span><span>Zone 4-5</span></div>
      </div>
      <div class="sec">JOUEURS EN DIRECT</div>
      <div id="plLive"></div>
      <div class="sec">ALERTES</div>
      <div id="sAlts"><div style="text-align:center;padding:14px;color:var(--txt);font-size:11px">Tous les joueurs dans les zones normales âœ“</div></div>
      <button style="width:100%;background:transparent;color:#FF8A80;border:1px solid rgba(255,61,61,.2);border-radius:10px;padding:12px;font-size:12px;cursor:pointer;font-family:'DM Sans';margin-top:8px" onclick="toggleSeance()">TERMINER LA SÃ‰ANCE</button>
    </div>
  </div>
</div>

<!-- CORPS -->

<div class="screen" id="s-corps">
  <div class="hdr"><div class="logo">REGE<span>RENT</span> PRO</div><div class="pill p-or">CORPS</div></div>
  <div class="scroll">
    <div class="htabs">
      <div class="htab on" onclick="ct(0,this)">CARTE</div>
      <div class="htab" onclick="ct(1,this)">BENCHMARKS</div>
      <div class="htab" onclick="ct(2,this)">PASSEPORT</div>
      <div class="htab" onclick="ct(3,this)">BLESSURES</div>
    </div>
    <!-- CARTE -->
    <div id="cb0">
      <div class="sec">ZONES SOUS SURVEILLANCE</div>
      <div class="card"><div style="font-size:9px;color:var(--txt);margin-bottom:8px">Analyse IA Â· 30 derniers jours</div><div class="bz-grid" id="bzGrid"></div><div style="display:flex;gap:12px;margin-top:9px;font-size:8px;color:var(--txt)"><span><span style="display:inline-block;width:6px;height:6px;border-radius:50%;background:var(--rouge);margin-right:4px"></span>Risque</span><span><span style="display:inline-block;width:6px;height:6px;border-radius:50%;background:var(--jaune);margin-right:4px"></span>Surveiller</span><span><span style="display:inline-block;width:6px;height:6px;border-radius:50%;background:var(--vert);margin-right:4px"></span>OK</span></div></div>
      <div class="sec">AVANT VS APRÃˆS REGERENT</div>
      <div class="card"><div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:10px"><div style="background:var(--g3);border-radius:12px;padding:12px;text-align:center"><div style="font-size:8px;color:var(--txt);margin-bottom:4px">AVANT</div><div style="font-family:'Bebas Neue';font-size:32px;color:var(--rouge)">3</div><div style="font-size:8px;color:var(--txt)">blessures/saison</div><div style="font-family:'Bebas Neue';font-size:18px;color:var(--rouge);margin-top:5px">18j</div><div style="font-size:8px;color:var(--txt)">rÃ©cup moyenne</div></div><div style="background:var(--g3);border-radius:12px;padding:12px;text-align:center"><div style="font-size:8px;color:var(--or);margin-bottom:4px">AVEC REGERENT</div><div style="font-family:'Bebas Neue';font-size:32px;color:var(--vert)">1</div><div style="font-size:8px;color:var(--txt)">blessures/saison</div><div style="font-family:'Bebas Neue';font-size:18px;color:var(--vert);margin-top:5px">7j</div><div style="font-size:8px;color:var(--txt)">rÃ©cup moyenne</div></div></div><div style="text-align:center;font-size:12px;font-weight:600;color:var(--or)">61% plus rapide avec REGERENT</div></div>
    </div>
    <!-- BENCHMARKS -->
    <div id="cb1" style="display:none">
      <div class="sec">TA POSITION Â· AILIER DROIT Â· NATIONAL</div>
      <div id="bkList"></div>
      <div class="sec">CLASSEMENT Ã‰QUIPE</div>
      <div id="rankList"></div>
    </div>
    <!-- PASSEPORT -->
    <div id="cb2" style="display:none">
      <div class="pp-card">
        <div class="pp-hdr"><div class="pp-badge">R</div><div><div class="pp-ttl">PASSEPORT PHYSIQUE</div><div class="pp-sub" id="ppSub">Actif depuis 6 mois Â· VÃ©rifiÃ©</div></div></div>
        <div class="pp-stats">
          <div class="pp-s"><div class="pp-sv" id="ppD">94%</div><div class="pp-sl">DISPO</div></div>
          <div class="pp-s"><div class="pp-sv" id="ppSm">74</div><div class="pp-sl">SCORE MOY.</div></div>
          <div class="pp-s"><div class="pp-sv" id="ppSt">12</div><div class="pp-sl">STREAK MAX</div></div>
        </div>
        <div class="pp-lock"><div class="pp-lock-ic">ğŸ”’</div><div>Le rapport complet est commandÃ© par les clubs Â· <span style="color:var(--or2);cursor:pointer">En savoir plus</span></div></div>
      </div>
      <div class="sec">TON PROFIL PUBLIC</div>
      <div class="card">
        <div style="font-size:10px;color:var(--txt);margin-bottom:8px">Ce que les clubs peuvent voir de toi</div>
        <div style="display:flex;justify-content:space-between;padding:7px 0;border-bottom:1px solid var(--bord);font-size:11px"><span style="color:var(--txt2)">ID REGERENT</span><span style="font-family:'Bebas Neue';letter-spacing:1px;color:var(--or2)">#RG-2847-FR</span></div>
        <div style="display:flex;justify-content:space-between;padding:7px 0;border-bottom:1px solid var(--bord);font-size:11px"><span style="color:var(--txt2)">Position</span><span>Ailier droit</span></div>
        <div style="display:flex;justify-content:space-between;padding:7px 0;border-bottom:1px solid var(--bord);font-size:11px"><span style="color:var(--txt2)">Niveau</span><span>National</span></div>
        <div style="display:flex;justify-content:space-between;padding:7px 0;border-bottom:1px solid var(--bord);font-size:11px"><span style="color:var(--txt2)">Score moyen (public)</span><span style="color:var(--or)">74</span></div>
        <div style="display:flex;justify-content:space-between;padding:7px 0;font-size:11px"><span style="color:var(--txt2)">DisponibilitÃ© (public)</span><span style="color:var(--vert)">94%</span></div>
      </div>
      <div class="card" style="background:rgba(0,230,118,.03);border-color:rgba(0,230,118,.15)">
        <div style="font-size:11px;color:var(--vert);font-weight:600;margin-bottom:5px">âœ“ Badge Passeport VÃ©rifiÃ©</div>
        <div style="font-size:10px;color:var(--txt2);line-height:1.6">Ton profil est visible par les clubs et agents sur REGERENT. Seules les donnÃ©es que tu autorises sont partagÃ©es.</div>
      </div>
    </div>
    <!-- BLESSURES -->
    <div id="cb3" style="display:none">
      <div style="display:flex;justify-content:space-between;align-items:center;margin:0 0 10px"><div class="sec" style="margin:0">HISTORIQUE</div><button onclick="addInj()" style="background:rgba(201,168,76,.06);border:1px solid rgba(201,168,76,.2);color:var(--or);border-radius:8px;padding:6px 11px;font-size:10px;cursor:pointer;font-family:'DM Sans'">+ Ajouter</button></div>
      <div id="injList"><div style="text-align:center;padding:28px;color:var(--txt);font-size:11px">Aucune blessure enregistrÃ©e</div></div>
    </div>
  </div>
</div>

<!-- COACH IA -->

<div class="screen" id="s-coach">
  <div class="hdr"><div><div style="font-size:8px;letter-spacing:2px;color:var(--txt);margin-bottom:2px">INTELLIGENCE ARTIFICIELLE</div><div class="logo">COACH <span>REGERENT</span></div></div><div class="pill p-vl">IA</div></div>
  <div class="scroll">
    <div class="card" style="margin-bottom:10px">
      <div style="display:flex;gap:10px;margin-bottom:7px"><div style="width:34px;height:34px;background:linear-gradient(135deg,var(--or),#CE93D8);border-radius:9px;display:flex;align-items:center;justify-content:center;font-family:'Bebas Neue';font-size:13px;color:var(--noir);flex-shrink:0">R</div><div><div style="font-weight:600;font-size:12px">Coach REGERENT IA</div><div style="font-size:9px;color:var(--txt2)">Analyse personnalisÃ©e Â· Football Pro</div></div></div>
      <div style="font-size:11px;color:var(--txt2);line-height:1.6">Pose-moi des questions sur ta rÃ©cupÃ©ration, tes donnÃ©es ou ta prÃ©paration.</div>
    </div>
    <div class="c-wrap" id="cMsgs">
      <div class="c-msg c-ai">Bonjour ! Je suis ton Coach REGERENT. Je connais tes donnÃ©es et peux t'aider Ã  optimiser ta rÃ©cupÃ©ration. Que veux-tu savoir ?</div>
    </div>
    <div class="c-inp-wrap"><input type="text" class="c-inp" id="cInp" placeholder="Pose ta question..." onkeydown="if(event.key==='Enter')sendC()"><button class="c-send" onclick="sendC()">â†’</button></div>
    <div class="sec">QUESTIONS FRÃ‰QUENTES</div>
    <div class="faq-item" onclick="askC('Comment amÃ©liorer mon HRV ?')"><span>Comment amÃ©liorer mon HRV ?</span><span style="color:var(--txt)">â€º</span></div>
    <div class="faq-item" onclick="askC('Quel protocole avant un match ?')"><span>Protocole avant un match ?</span><span style="color:var(--txt)">â€º</span></div>
    <div class="faq-item" onclick="askC('Pourquoi mon score est bas ?')"><span>Pourquoi mon score est bas ?</span><span style="color:var(--txt)">â€º</span></div>
    <div class="faq-item" onclick="askC('Comment prÃ©venir les blessures ischios ?')"><span>PrÃ©vention blessures ischios ?</span><span style="color:var(--txt)">â€º</span></div>
    <div class="faq-item" onclick="askC('Que signifie mon passeport REGERENT ?')"><span>Mon Passeport REGERENT ?</span><span style="color:var(--txt)">â€º</span></div>
  </div>
</div>

<!-- MARKETPLACE -->

<div class="screen" id="s-market">
  <div class="hdr"><div class="logo">REGE<span>RENT</span> STORE</div><div class="pill p-or">MARKETPLACE</div></div>
  <div class="scroll">
    <div class="card" style="background:rgba(0,230,118,.03);border-color:rgba(0,230,118,.15);margin-bottom:12px">
      <div style="font-size:10px;color:var(--vert);font-weight:600;margin-bottom:3px">âœ“ Recommandations personnalisÃ©es</div>
      <div style="font-size:10px;color:var(--txt2);line-height:1.6">BasÃ©es sur tes zones de risque et tes donnÃ©es REGERENT</div>
    </div>
    <div class="sec">RÃ‰CUPÃ‰RATION Â· RECOMMANDÃ‰ POUR TOI</div>
    <div class="mkt-grid" id="mktRec"></div>
    <div class="sec">Ã‰QUIPEMENT TERRAIN</div>
    <div class="mkt-grid" id="mktEq"></div>
    <div class="sec">NUTRITION</div>
    <div class="mkt-grid" id="mktNut"></div>
  </div>
</div>

<!-- PROFIL JOUEUR -->

<div class="screen" id="s-profil">
  <div class="hdr"><div class="logo">REGE<span>RENT</span> PRO</div><div class="pill p-or">PROFIL</div></div>
  <div class="scroll">
    <div style="text-align:center;padding:14px 0 20px"><div class="p-av" id="pAv">?</div><div style="font-family:'Bebas Neue';font-size:21px;letter-spacing:2px" id="pNm">--</div><div style="font-size:11px;color:var(--txt2);margin-top:3px" id="pSb">--</div></div>
    <div class="stat-row" style="margin-bottom:12px"><div class="sb"><div class="sb-v">12</div><div class="sb-l">BILANS</div></div><div class="sb"><div class="sb-v">94%</div><div class="sb-l">DISPO</div></div><div class="sb"><div class="sb-v">74</div><div class="sb-l">SCORE MOY.</div></div><div class="sb"><div class="sb-v">7</div><div class="sb-l">STREAK</div></div></div>
    <div class="sec">Ã‰QUIPEMENTS REGERENT</div>
    <div class="eq-row"><div><div style="font-weight:600;font-size:12px">REGERENT BAND</div><div style="font-size:10px;color:var(--txt2);margin-top:1px">Bracelet 24/7 Â· HRV Â· SpO2 Â· TempÃ©rature</div></div><div class="eq-st eq-on">ACTIF</div></div>
    <div class="eq-row"><div><div style="font-weight:600;font-size:12px">REGERENT VEST</div><div style="font-size:10px;color:var(--txt2);margin-top:1px">Veste GPS sÃ©ance Â· Distance Â· Vitesse</div></div><div class="eq-st eq-off">NON LIÃ‰</div></div>
    <div class="eq-row"><div><div style="font-weight:600;font-size:12px">OXY ONE</div><div style="font-size:10px;color:var(--txt2);margin-top:1px">Chambre hyperbare</div></div><div class="eq-st eq-on">ACTIF</div></div>
    <div class="eq-row"><div><div style="font-weight:600;font-size:12px">CRYO ONE</div><div style="font-size:10px;color:var(--txt2);margin-top:1px">CryothÃ©rapie</div></div><div class="eq-st eq-on">ACTIF</div></div>
    <div class="sec">ABONNEMENT</div>
    <div class="card-or"><div style="display:flex;justify-content:space-between;align-items:center"><div><div style="font-weight:600;font-size:13px;color:var(--or2)">REGERENT PRO</div><div style="font-size:10px;color:var(--txt2);margin-top:2px">Actif Â· Renouvellement 27 mars</div></div><div style="font-family:'Bebas Neue';font-size:22px;color:var(--or)">69â‚¬/mois</div></div></div>
    <div style="margin-top:14px;margin-bottom:10px"><button style="background:transparent;color:var(--txt);border:1px solid var(--bord);border-radius:9px;padding:8px 14px;font-size:11px;cursor:pointer;font-family:'DM Sans'" onclick="doLogout()">Se dÃ©connecter</button></div>
  </div>
</div>

<!-- ========== AGENT SCREENS ========== -->

<div class="screen" id="s-agent">
  <div class="hdr"><div><div style="font-size:8px;letter-spacing:2px;color:var(--txt);margin-bottom:2px">MODE AGENT</div><div class="logo">REGE<span>RENT</span> PRO</div></div><div class="pill p-bl">AGENT</div></div>
  <div class="scroll">
    <div class="card" style="margin-bottom:12px">
      <div style="display:flex;align-items:center;justify-content:space-between">
        <div><div style="font-weight:600;font-size:13px">Momar Diallo Agency</div><div style="font-size:10px;color:var(--txt2);margin-top:2px">12 joueurs Â· 3 collaborateurs</div></div>
        <div class="pill p-bl">PRO</div>
      </div>
    </div>
    <div class="sec">MON PORTEFEUILLE</div>
    <div id="agJoueurs"></div>
    <div class="sec">RAPPORTS DE TRANSFERT</div>
    <div class="card-or">
      <div style="font-family:'Bebas Neue';font-size:11px;letter-spacing:2px;color:var(--or);margin-bottom:10px">COMMANDER UN RAPPORT</div>
      <div style="font-size:11px;color:var(--txt2);margin-bottom:12px;line-height:1.6">SÃ©lectionne un joueur et le type de rapport. Le club reÃ§oit un lien de paiement sÃ©curisÃ©.</div>
      <div class="prix-sel">
        <div class="prix-card on" onclick="selPrix(0,this)"><div class="prix-ttl">BASIC</div><div class="prix-val">99â‚¬</div><div class="prix-dur">6 mois</div></div>
        <div class="prix-card" onclick="selPrix(1,this)"><div class="prix-ttl">PRO</div><div class="prix-val">199â‚¬</div><div class="prix-dur">12 mois</div></div>
        <div class="prix-card" onclick="selPrix(2,this)"><div class="prix-ttl">ELITE</div><div class="prix-val">499â‚¬</div><div class="prix-dur">24 mois</div></div>
      </div>
      <button class="rapport-btn" onclick="genRapport()">GÃ‰NÃ‰RER LIEN DE PAIEMENT â†’</button>
    </div>
    <div class="sec">HISTORIQUE RAPPORTS</div>
    <div id="agRapports"></div>
  </div>
</div>

<!-- ========== STAFF SCREENS ========== -->

<div class="screen" id="s-staff">
  <div class="hdr"><div><div style="font-size:8px;letter-spacing:2px;color:var(--txt);margin-bottom:2px">MODE STAFF</div><div class="logo">REGE<span>RENT</span> PRO</div></div><div class="pill p-vt">STAFF</div></div>
  <div class="scroll">
    <div class="card" style="margin-bottom:10px">
      <div style="display:flex;align-items:center;justify-content:space-between">
        <div><div style="font-weight:600;font-size:13px">Berrichonne de ChÃ¢teauroux</div><div style="font-size:10px;color:var(--txt2);margin-top:2px">RÃ©serve Â· 24 joueurs actifs</div></div>
        <div class="pill p-vt">TEAM</div>
      </div>
    </div>
    <div class="sec">Ã‰TAT DE L'EFFECTIF AUJOURD'HUI</div>
    <div class="mg" style="margin-bottom:10px">
      <div class="mi"><div class="mi-ic">âœ…</div><div class="mi-v" style="color:var(--vert)" id="stDispo">18</div><div class="mi-l">DISPONIBLES</div></div>
      <div class="mi"><div class="mi-ic">âš ï¸</div><div class="mi-v" style="color:var(--jaune)" id="stSurv">4</div><div class="mi-l">Ã€ SURVEILLER</div></div>
      <div class="mi"><div class="mi-ic">ğŸ”´</div><div class="mi-v" style="color:var(--rouge)" id="stRisk">2</div><div class="mi-l">Ã€ RISQUE</div></div>
      <div class="mi"><div class="mi-ic">ğŸ“Š</div><div class="mi-v" id="stAvg">72</div><div class="mi-l">SCORE MOY.</div></div>
    </div>
    <div class="sec">ALERTES PRÃ‰DICTIVES</div>
    <div id="stAlerts"></div>
    <div class="sec">Ã‰QUIPE â€” SCORES DU JOUR</div>
    <div class="team-grid" id="stTeam"></div>
    <div class="sec">CHARGE SEMAINE Ã‰QUIPE</div>
    <div class="card-dk">
      <div class="wbars" id="stBars" style="height:60px"></div>
      <div style="display:flex;justify-content:space-between;font-size:8px;color:var(--txt);padding:4px 2px 0"><span>L</span><span>M</span><span>M</span><span>J</span><span>V</span><span>S</span><span>D</span></div>
    </div>
    <div class="sec">PLANIFICATION SÃ‰ANCE</div>
    <div class="card">
      <div style="font-size:11px;font-weight:600;margin-bottom:8px">Prochaine sÃ©ance â€” Demain 10h00</div>
      <div style="font-size:10px;color:var(--txt2);line-height:1.7">REGERENT recommande : intensitÃ© modÃ©rÃ©e (zone 3 max) â€” 3 joueurs ont un score sous 65 ce matin. Ã‰viter les sprints intensifs pour Kofi D., Marc T. et Samba B.</div>
      <button class="btn-g" style="margin-top:10px;font-size:14px;padding:11px">VALIDER LA PLANIFICATION</button>
    </div>
  </div>
</div>

<!-- CALENDRIER STAFF -->

<div class="screen" id="s-staffcal">
  <div class="hdr"><div class="logo">REGE<span>RENT</span> PRO</div><div class="pill p-vt">CALENDRIER</div></div>
  <div class="scroll">
    <div class="card">
      <div class="cal-hdr">
        <button class="cal-nav" onclick="calStaffNav(-1)">â€¹</button>
        <div class="cal-title" id="calStaffTitle"></div>
        <button class="cal-nav" onclick="calStaffNav(1)">â€º</button>
      </div>
      <div class="cal-days-hdr"><div class="cal-dh">L</div><div class="cal-dh">M</div><div class="cal-dh">M</div><div class="cal-dh">J</div><div class="cal-dh">V</div><div class="cal-dh">S</div><div class="cal-dh">D</div></div>
      <div class="cal-grid" id="calStaffGrid"></div>
    </div>
    <div class="sec">LÃ‰GENDE</div>
    <div class="card">
      <div style="display:flex;gap:12px;flex-wrap:wrap">
        <div style="display:flex;align-items:center;gap:6px;font-size:10px"><span style="width:14px;height:14px;border-radius:4px;background:rgba(0,230,118,.3);display:inline-block"></span>Bonne rÃ©cup</div>
        <div style="display:flex;align-items:center;gap:6px;font-size:10px"><span style="width:14px;height:14px;border-radius:4px;background:rgba(255,179,0,.3);display:inline-block"></span>ModÃ©rÃ©</div>
        <div style="display:flex;align-items:center;gap:6px;font-size:10px"><span style="width:14px;height:14px;border-radius:4px;background:rgba(255,61,61,.3);display:inline-block"></span>Faible rÃ©cup</div>
        <div style="display:flex;align-items:center;gap:6px;font-size:10px"><span style="width:14px;height:14px;border-radius:4px;background:rgba(41,121,255,.3);display:inline-block"></span>Match</div>
      </div>
    </div>
  </div>
</div>

<!-- NAV JOUEUR -->

<nav class="nav" id="nav">
  <div class="ntabs">
    <div class="nt on" onclick="goTo('s-home')" id="n-home"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9,22 9,12 15,12 15,22"/></svg>Accueil</div>
    <div class="nt" onclick="goTo('s-bilan')" id="n-bilan"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="12" cy="12" r="10"/><polyline points="12,6 12,12 16,14"/></svg>Bilan</div>
    <div class="nt" onclick="goTo('s-cal')" id="n-cal"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Calendrier</div>
    <div class="nt" onclick="goTo('s-seance')" id="n-seance"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><polygon points="5,3 19,12 5,21 5,3"/></svg>SÃ©ance</div>
    <div class="nt" onclick="goTo('s-corps')" id="n-corps"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>Corps</div>
    <div class="nt" onclick="goTo('s-coach')" id="n-coach"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>Coach IA</div>
    <div class="nt" onclick="goTo('s-market')" id="n-market"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>Store</div>
    <div class="nt" onclick="goTo('s-profil')" id="n-profil"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>Profil</div>
  </div>
</nav>

<!-- NAV AGENT -->

<nav class="nav" id="nav-agent" style="display:none">
  <div class="ntabs">
    <div class="nt on" onclick="goTo('s-agent')" id="na-port"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>Portefeuille</div>
    <div class="nt" onclick="goTo('s-coach')" id="na-coach"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>Coach IA</div>
    <div class="nt" onclick="doLogout()" id="na-out"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16,17 21,12 16,7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>Quitter</div>
  </div>
</nav>

<!-- NAV STAFF -->

<nav class="nav" id="nav-staff" style="display:none">
  <div class="ntabs">
    <div class="nt on" onclick="goTo('s-staff')" id="ns-home"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></svg>Ã‰quipe</div>
    <div class="nt" onclick="goTo('s-staffcal')" id="ns-cal"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Calendrier</div>
    <div class="nt" onclick="goTo('s-seance')" id="ns-seance"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><polygon points="5,3 19,12 5,21 5,3"/></svg>SÃ©ance</div>
    <div class="nt" onclick="goTo('s-coach')" id="ns-coach"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>Coach IA</div>
    <div class="nt" onclick="doLogout()" id="ns-out"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16,17 21,12 16,7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>Quitter</div>
  </div>
</nav>

<script>
// ===== CONFIG =====
const SB='https://lmwmaqwbktiqrjgctljg.supabase.co',KEY='sb_publishable_7xpalz5r3f90dGR117tJCg_z0N4rNE5';
let token=null,uid=null,profile=null,todayB=null,curMode='joueur';
let seanceOn=false,seanceSec=0,seanceItv=null;
let calYear=new Date().getFullYear(),calMonth=new Date().getMonth();
let calStaffYear=new Date().getFullYear(),calStaffMonth=new Date().getMonth();
let qStep=1,tapVals=[null,null,null,null,null];

// ===== SUPABASE =====
async function sbApi(m,p,b,h={}){
  const hh={'Content-Type':'application/json','apikey':KEY,'Authorization':'Bearer '+(token||KEY),...h};
  const r=await fetch(SB+p,{method:m,headers:hh,body:b?JSON.stringify(b):undefined});
  const t=await r.text();try{return JSON.parse(t);}catch{return t;}
}
async function dbGet(t,f){return sbApi('GET','/rest/v1/'+t+'?'+(f||''));}
async function dbPost(t,b){return sbApi('POST','/rest/v1/'+t,b,{'Prefer':'return=minimal'});}
async function dbUpsert(t,b){return sbApi('POST','/rest/v1/'+t,b,{'Prefer':'resolution=merge-duplicates,return=minimal'});}
async function authApi(m,p,b){const h={'Content-Type':'application/json','apikey':KEY};if(token)h['Authorization']='Bearer '+token;const r=await fetch(SB+'/auth/v1'+p,{method:m,headers:h,body:b?JSON.stringify(b):undefined});return r.json();}

// ===== INIT =====
async function init(){
  token=localStorage.getItem('rg_t');uid=localStorage.getItem('rg_u');curMode=localStorage.getItem('rg_mode')||'joueur';
  selMode(curMode,true);
  if(token&&uid){
    try{
      const p=await dbGet('profiles','id=eq.'+uid+'&select=*');
      if(Array.isArray(p)&&p[0]){profile=p[0];launch();return;}
    }catch(e){}
  }
  goTo('s-auth');
}

// ===== AUTH =====
let selectedMode='joueur';
function selMode(m,silent){
  selectedMode=m;
  document.querySelectorAll('.ms-btn').forEach(b=>b.classList.remove('active'));
  const map={joueur:'ms-j',agent:'ms-a',staff:'ms-s'};
  document.getElementById(map[m])?.classList.add('active');
  const jf=document.getElementById('j-fields');
  if(jf)jf.style.display=m==='joueur'?'block':'none';
}
function aTab(t){
  ['tL','tR'].forEach(id=>document.getElementById(id).classList.remove('on'));
  document.getElementById(t==='l'?'tL':'tR').classList.add('on');
  document.getElementById('fL').style.display=t==='l'?'block':'none';
  document.getElementById('fR').style.display=t==='r'?'block':'none';
}
async function doLogin(){
  const e=document.getElementById('lE').value.trim(),p=document.getElementById('lP').value,err=document.getElementById('lErr');
  err.style.display='none';
  if(!e||!p){err.textContent='Remplis tous les champs';err.style.display='block';return;}
  try{
    const d=await authApi('POST','/token?grant_type=password',{email:e,password:p});
    if(!d.access_token){err.textContent='Email ou mot de passe incorrect';err.style.display='block';return;}
    token=d.access_token;uid=d.user.id;
    localStorage.setItem('rg_t',token);localStorage.setItem('rg_u',uid);localStorage.setItem('rg_mode',selectedMode);
    const pr=await dbGet('profiles','id=eq.'+uid+'&select=*');
    if(!Array.isArray(pr)||!pr[0]){err.textContent='Profil introuvable';err.style.display='block';return;}
    profile=pr[0];curMode=selectedMode;launch();
  }catch(e){err.textContent='Erreur de connexion';err.style.display='block';}
}
async function doRegister(){
  const pr=document.getElementById('rPr').value.trim(),no=document.getElementById('rNo').value.trim();
  const e=document.getElementById('rE').value.trim(),p=document.getElementById('rP').value;
  const pos=document.getElementById('rPos')?.value||'',cl=document.getElementById('rCl').value.trim();
  const err=document.getElementById('rErr');err.style.display='none';
  if(!pr||!no||!e||!p){err.textContent='Remplis tous les champs';err.style.display='block';return;}
  if(p.length<8){err.textContent='Mot de passe min. 8 caractÃ¨res';err.style.display='block';return;}
  try{
    const d=await authApi('POST','/signup',{email:e,password:p});
    if(!d.access_token){err.textContent=d.msg||'Erreur';err.style.display='block';return;}
    token=d.access_token;uid=d.user.id;
    localStorage.setItem('rg_t',token);localStorage.setItem('rg_u',uid);localStorage.setItem('rg_mode',selectedMode);
    const h={'Content-Type':'application/json','apikey':KEY,'Authorization':'Bearer '+token,'Prefer':'return=minimal'};
    await fetch(SB+'/rest/v1/profiles',{method:'POST',headers:h,body:JSON.stringify({id:uid,role:selectedMode,nom:no,prenom:pr,position:pos,club:cl})});
    profile={id:uid,role:selectedMode,nom:no,prenom:pr,position:pos,club:cl};
    curMode=selectedMode;launch();toast('Bienvenue '+pr+' !');
  }catch(e){err.textContent='Erreur. RÃ©essaie.';err.style.display='block';}
}
async function demo(){
  curMode=selectedMode;
  profile={prenom:'Kofi',nom:'Diallo',role:curMode,position:'Ailier droit',club:'Berrichonne de ChÃ¢teauroux'};
  // GÃ©nÃ©rer donnÃ©es dÃ©mo avec historique complet
  genDemoData();
  launch();
  toast('Mode dÃ©mo â€” explore librement');
}

// ===== DEMO DATA =====
function genDemoData(){
  const stored={};
  const now=new Date();
  for(let i=60;i>=0;i--){
    const d=new Date(now);d.setDate(d.getDate()-i);
    const ds=d.toISOString().split('T')[0];
    if(Math.random()>.2){
      const sc=Math.round(55+Math.random()*35);
      const c=sc>=80?'vert':sc>=60?'jaune':'rouge';
      stored[ds]={score_regerent:sc,couleur_score:c,heures_sommeil:parseFloat((6+Math.random()*3).toFixed(1)),qualite_sommeil:Math.round(4+Math.random()*6),ressenti_physique:Math.round(4+Math.random()*6),ressenti_mental:Math.round(4+Math.random()*6),zones_douleur:Math.random()>.7?['Ischio G']:['Aucune'],equipements_utilises:Math.random()>.5?['OXY_ONE']:['rien'],hrv_simule:Math.round(45+sc*.35+Math.random()*8)};
    }
  }
  localStorage.setItem('rg_demo_history',JSON.stringify(stored));
  const today=now.toISOString().split('T')[0];
  todayB=stored[today]||null;
}
function getDemoHistory(){
  try{return JSON.parse(localStorage.getItem('rg_demo_history')||'{}');}catch{return {};}
}

// ===== LAUNCH =====
function launch(){
  const mode=profile?.role||curMode;
  // Afficher la bonne nav
  document.getElementById('nav').style.display=mode==='joueur'?'flex':'none';
  document.getElementById('nav-agent').style.display=mode==='agent'?'flex':'none';
  document.getElementById('nav-staff').style.display=mode==='staff'?'flex':'none';

  if(mode==='joueur'){
    buildHome();buildCal();buildCorps();buildMarket();buildProfil();buildBhv();buildWeek();
    goTo('s-home');
  }else if(mode==='agent'){
    buildAgent();goTo('s-agent');
  }else if(mode==='staff'){
    buildStaff();buildStaffCal();goTo('s-staff');
  }
}

// ===== LOGOUT =====
async function doLogout(){
  localStorage.removeItem('rg_t');localStorage.removeItem('rg_u');localStorage.removeItem('rg_mode');
  token=null;uid=null;profile=null;todayB=null;
  ['nav','nav-agent','nav-staff'].forEach(id=>document.getElementById(id).style.display='none');
  goTo('s-auth');
}

// ===== HOME =====
async function buildHome(){
  if(!profile)return;
  const h=new Date().getHours();
  document.getElementById('greet').textContent=(h<12?'BON MATIN':h<18?'BON APRÃˆS-MIDI':'BONNE SOIRÃ‰E')+' '+profile.prenom.toUpperCase();
  document.getElementById('hPill').textContent=(profile.position||'JOUEUR').toUpperCase();
  if(uid){
    const today=new Date().toISOString().split('T')[0];
    const d=await dbGet('bilans','joueur_id=eq.'+uid+'&date=eq.'+today+'&select=*');
    todayB=Array.isArray(d)&&d[0]?d[0]:null;
  }
  renderHome();
}
function renderHome(){
  if(todayB&&todayB.score_regerent!=null){
    document.getElementById('bilanCTA').style.display='none';
    const s=todayB.score_regerent,c=todayB.couleur_score||'jaune';
    const sS=Math.round((todayB.heures_sommeil||7)/11*100);
    const sC=Math.round((todayB.ressenti_physique||7)/10*100);
    const sM=Math.round((todayB.ressenti_mental||7)/10*100);
    setTimeout(()=>showRings(s,c,sS,sC,sM),300);
    document.getElementById('mS').textContent=(todayB.heures_sommeil||'--')+'h';
    document.getElementById('mH').textContent=todayB.hrv_simule||Math.round(40+s*.3);
    document.getElementById('mP').textContent=(todayB.ressenti_physique||'--')+'/10';
    document.getElementById('mM').textContent=(todayB.ressenti_mental||'--')+'/10';
    const hs=todayB.heures_sommeil||0;
    const mST=document.getElementById('mST');mST.textContent=hs>=8?'Optimal':hs>=7?'Correct':'Insuffisant';
    mST.className='mi-t '+(hs>=8?'t-up':hs>=7?'t-fl':'t-dn');
    const hrv=parseInt(document.getElementById('mH').textContent)||0;
    const mHT=document.getElementById('mHT');mHT.textContent=hrv>=60?'Ã‰levÃ©':hrv>=45?'Normal':'Bas';
    mHT.className='mi-t '+(hrv>=60?'t-up':hrv>=45?'t-fl':'t-dn');
    // Alertes
    const al=document.getElementById('homeAlrt');al.innerHTML='';
    if(todayB.alerte&&todayB.alerte_message){
      al.innerHTML=`<div class="alrt-card"><div class="alrt-ic">âš ï¸</div><div><div class="alrt-t">SIGNAL DÃ‰TECTÃ‰</div><div class="alrt-d">${todayB.alerte_message}</div></div></div>`;
    }
    // Protocole
    if(s<80){
      document.getElementById('protoHome').style.display='block';
      const dz=(todayB.zones_douleur||[]).filter(z=>z!='Aucune');
      const steps=[];
      if(s<60)steps.push({i:'ğŸ«',t:'OXY ONE â€” 90 min',d:'PrioritÃ© ce soir. Chambre hyperbare maximise la rÃ©cupÃ©ration musculaire.'});
      if(dz.length)steps.push({i:'ğŸ§Š',t:'CRYO ONE â€” 20 min',d:'Zones : '+dz.join(', ')+'. Application ciblÃ©e.'});
      if(hs<7)steps.push({i:'ğŸ˜´',t:(s<60?'9h':'8h30')+' de sommeil',d:'Coucher avant 22h30. PrioritÃ© absolue ce soir.'});
      steps.push({i:'ğŸ’§',t:'Hydratation + protÃ©ines',d:'3L eau + protÃ©ines 2h post-sÃ©ance.'});
      document.getElementById('protoHomeSteps').innerHTML=steps.map(p=>`<div class="proto-item"><div class="pi-ic">${p.i}</div><div><div class="pi-t">${p.t}</div><div class="pi-d">${p.d}</div></div></div>`).join('');
    }else document.getElementById('protoHome').style.display='none';
  }else{
    document.getElementById('bilanCTA').style.display='block';
    document.getElementById('protoHome').style.display='none';
  }
}
function showRings(s,c,sS,sC,sM){
  const col=c==='vert'?'var(--vert)':c==='rouge'?'var(--rouge)':'var(--or)';
  document.getElementById('rVal').textContent=s;document.getElementById('rVal').style.color=col;
  document.getElementById('rFg').style.stroke=col;
  document.getElementById('rFg').style.strokeDashoffset=452-(452*s/100);
  document.getElementById('rSt').textContent=c==='vert'?'PrÃªt. Donne tout.':c==='rouge'?'RÃ©cupÃ©ration prioritaire.':'GÃ¨re ton intensitÃ©.';
  [[1,sS,'var(--vert2)'],[2,sC,'var(--or)'],[3,sM,'#CE93D8']].forEach(([i,v,col])=>{
    document.getElementById('m'+i).style.strokeDashoffset=125.6-(125.6*v/100);
    document.getElementById('mv'+i).textContent=v+'%';
  });
}
function buildWeek(){
  const hist=getDemoHistory();
  const sc=[];
  for(let i=6;i>=0;i--){const d=new Date();d.setDate(d.getDate()-i);const k=d.toISOString().split('T')[0];sc.push(hist[k]?.score_regerent||0);}
  document.getElementById('wbars7').innerHTML=sc.map((s,i)=>{
    const c=s>=80?'var(--vert)':s>=60?'var(--or)':s>0?'var(--rouge)':'var(--g4)';
    const h=s>0?Math.round(s*.55)+5:3;const t=i===6;
    return`<div class="wb-w"><div style="font-size:8px;font-weight:600;color:${s>0?c:'var(--g5)'}">${s||''}</div><div class="wb" style="height:${h}px;background:${c}${t?';box-shadow:0 0 8px '+c:''}"></div></div>`;
  }).join('');
}
function buildBhv(){
  const bh=[{n:'OXY ONE utilisÃ©',p:82,c:'var(--vert)',d:1},{n:'Sommeil 8h+',p:64,c:'var(--vert2)',d:1},{n:'Hydratation',p:71,c:'var(--bleu)',d:1},{n:'Alcool',p:15,c:'var(--rouge)',d:-1},{n:'Ã‰crans avant dodo',p:45,c:'var(--jaune)',d:-1}];
  document.getElementById('bhvCard').innerHTML='<div style="font-size:9px;color:var(--txt);margin-bottom:8px">Impact sur ta rÃ©cupÃ©ration</div>'+bh.map(b=>`<div style="display:flex;align-items:center;gap:8px;padding:7px 0;border-bottom:1px solid var(--bord)"><div style="flex:1;font-size:10px">${b.n}</div><div style="flex:2;height:3px;background:var(--g4);border-radius:3px;overflow:hidden"><div style="height:100%;width:${b.p}%;background:${b.c};border-radius:3px"></div></div><div style="font-size:9px;font-weight:600;width:32px;text-align:right;color:${b.d>0?'var(--vert)':'var(--rouge)'}">${b.d>0?'+'+b.p+'%':'-'+Math.round(b.p/4)+'%'}</div></div>`).join('');
}

// ===== BILAN =====
function qNext(from){
  if(from===0&&!tapVals[0]){toast('SÃ©lectionne une option');return;}
  if(from===4&&!tapVals[4]){tapVals[4]=parseInt(document.getElementById('r5').value);}
  const next=from+1;
  document.getElementById('qs'+(from+1))?.classList.remove('active');
  if(next<=5){
    document.getElementById('qs'+next)?.classList.add('active');
    qStep=next;
    document.getElementById('qFill').style.width=Math.round(next/5*100)+'%';
    document.getElementById('qPct').textContent=next+'/5';
  }
}
function qBack(from){
  document.getElementById('qs'+(from+1))?.classList.remove('active');
  document.getElementById('qs'+from)?.classList.add('active');
  qStep=from;
  document.getElementById('qFill').style.width=Math.round(from/5*100)+'%';
  document.getElementById('qPct').textContent=from+'/5';
}
function selTap(idx,el){
  el.closest('.tap-opts').querySelectorAll('.tap-opt').forEach(t=>t.classList.remove('sel'));
  el.classList.add('sel');tapVals[idx]=parseInt(el.dataset.v);
}
function tPain(el){
  if(el.textContent==='Aucune'){document.querySelectorAll('#painC .chip').forEach(c=>c.classList.remove('on-r'));el.classList.add('on-g');}
  else{document.querySelector('#painC .chip:first-child')?.classList.remove('on-g');el.classList.toggle('on-r');}
}
function tEquip(el){
  if(el.dataset.v==='rien'){document.querySelectorAll('#equipC .chip').forEach(c=>c.classList.remove('on-g'));el.classList.add('on-g');}
  else{document.querySelector('#equipC [data-v="rien"]')?.classList.remove('on-g');el.classList.toggle('on-g');}
}
async function submitBilan(){
  tapVals[1]=parseFloat(document.getElementById('r2').value);
  tapVals[4]=parseInt(document.getElementById('r5').value);
  const rv=tapVals[0]||7,hs=tapVals[1]||7,rp=7,rm=tapVals[4]||7;
  const zd=[...document.querySelectorAll('#painC .chip.on-r')].map(c=>c.textContent);
  const eu=[...document.querySelectorAll('#equipC .chip.on-g')].map(c=>c.dataset.v);
  // Algo score
  let ps=hs>=8.5?22:hs>=8?20:hs>=7.5?17:hs>=7?14:hs>=6?8:2;
  ps+=Math.min(15,Math.round(rv*1.5));
  const score=Math.max(0,Math.min(100,ps+Math.min(20,Math.round(rp*2))+Math.min(15,Math.round(rm*1.5))+(!zd.length?10:zd.length===1?5:0)+Math.min(10,(eu.includes('OXY_ONE')?5:0)+(eu.includes('CRYO_ONE')?4:0)+(eu.includes('PRESSO_ONE')?3:0)+(eu.includes('BAND')?3:0))));
  const c=score>=80?'vert':score>=60?'jaune':'rouge';
  const hrv_simule=Math.round(42+score*.35+Math.random()*8);
  let alerte=false,alerte_message=null;
  if(hs<7&&zd.length){alerte=true;alerte_message='Combinaison critique : sommeil insuffisant ('+hs+'h) + douleur dÃ©tectÃ©e. Risque blessure musculaire. OXY ONE ce soir obligatoire.';}
  else if(hs<6){alerte=true;alerte_message='Nuit trop courte ('+hs+'h). RÃ©cupÃ©ration musculaire et immunitaire compromise.';}
  else if(rv<=3){alerte=true;alerte_message='Ressenti trÃ¨s bas au rÃ©veil. Surveiller la charge des prochaines 48h.';}
  const today=new Date().toISOString().split('T')[0];
  const payload={joueur_id:uid||'demo',date:today,heures_sommeil:hs,qualite_sommeil:8,ressenti_physique:rp,ressenti_mental:rm,zones_douleur:zd.length?zd:['Aucune'],equipements_utilises:eu,score_regerent:score,couleur_score:c,alerte,alerte_message,hrv_simule};
  if(uid){await dbUpsert('bilans',payload).catch(()=>{});}
  // Sauvegarder dans dÃ©mo history
  const hist=getDemoHistory();hist[today]=payload;localStorage.setItem('rg_demo_history',JSON.stringify(hist));
  todayB=payload;
  // Afficher success
  const col=c==='vert'?'var(--vert)':c==='rouge'?'var(--rouge)':'var(--or)';
  document.getElementById('okRing').textContent=c==='vert'?'ğŸ’š':c==='rouge'?'ğŸ”´':'âš¡';
  document.getElementById('okRing').style.background=c==='vert'?'rgba(0,230,118,.1)':c==='rouge'?'rgba(255,61,61,.1)':'rgba(201,168,76,.1)';
  document.getElementById('okScore').textContent=score;document.getElementById('okScore').style.color=col;
  document.getElementById('okVerb').textContent=c==='vert'?'PrÃªt. Ton corps est en forme. Donne tout aujourd\'hui.':c==='rouge'?'Ton corps parle. PrioritÃ© : rÃ©cupÃ©ration. Suis ton protocole.':'GÃ¨re ton intensitÃ©. Protocole REGERENT ce soir.';
  const dz=(payload.zones_douleur||[]).filter(z=>z!='Aucune');
  const steps=[];
  if(score<60)steps.push({i:'ğŸ«',t:'OXY ONE 90 min',d:'Ce soir, prioritÃ© absolue.'});
  if(dz.length)steps.push({i:'ğŸ§Š',t:'CRYO ONE 20 min',d:dz.join(', ')});
  if(hs<7)steps.push({i:'ğŸ˜´',t:'8h30+ de sommeil',d:'Coucher avant 22h30.'});
  document.getElementById('protoOvl').innerHTML='<div class="proto-ttl">PROTOCOLE CE SOIR</div>'+steps.map(p=>`<div class="proto-item"><div class="pi-ic">${p.i}</div><div><div class="pi-t">${p.t}</div><div class="pi-d">${p.d}</div></div></div>`).join('');
  document.getElementById('ovl').classList.add('show');
}
function closeOvl(){document.getElementById('ovl').classList.remove('show');buildHome();buildCal();buildWeek();goTo('s-home');}

// ===== CALENDRIER =====
function buildCal(){
  renderCal();
}
function renderCal(){
  const hist=getDemoHistory();
  const months=['JANVIER','FÃ‰VRIER','MARS','AVRIL','MAI','JUIN','JUILLET','AOÃ›T','SEPTEMBRE','OCTOBRE','NOVEMBRE','DÃ‰CEMBRE'];
  document.getElementById('calTitle').textContent=months[calMonth]+' '+calYear;
  const first=new Date(calYear,calMonth,1);
  let dow=first.getDay()-1;if(dow<0)dow=6;
  const days=new Date(calYear,calMonth+1,0).getDate();
  const today=new Date();
  let html='';
  for(let i=0;i<dow;i++)html+='<div class="cal-day empty"></div>';
  for(let d=1;d<=days;d++){
    const ds=calYear+'-'+String(calMonth+1).padStart(2,'0')+'-'+String(d).padStart(2,'0');
    const data=hist[ds];
    const isToday=today.getFullYear()===calYear&&today.getMonth()===calMonth&&today.getDate()===d;
    const isFuture=new Date(ds)>today;
    let bg='background:var(--g2)';let color='color:var(--txt2)';let dot='';
    if(data){
      const sc=data.score_regerent;
      const cc=sc>=80?'rgba(0,230,118,.25)':sc>=60?'rgba(255,179,0,.25)':'rgba(255,61,61,.25)';
      const dc=sc>=80?'var(--vert)':sc>=60?'var(--jaune)':'var(--rouge)';
      bg='background:'+cc;color='color:var(--blanc)';
      dot=`<div class="day-dot" style="background:${dc}"></div>`;
    }else if(isFuture){bg='background:transparent';color='color:var(--g5)';}
    html+=`<div class="cal-day has-data ${isToday?'today':''}" style="${bg};${color}" onclick="showDayDetail('${ds}')">${d}${dot}</div>`;
  }
  document.getElementById('calGrid').innerHTML=html;
  // Stats du mois
  const monthData=Object.entries(hist).filter(([k])=>k.startsWith(calYear+'-'+String(calMonth+1).padStart(2,'0')));
  const scores=monthData.map(([,v])=>v.score_regerent||0).filter(s=>s>0);
  const avg=scores.length?Math.round(scores.reduce((a,b)=>a+b,0)/scores.length):0;
  // Streak
  let streak=0,cur=0;
  const sorted=Object.keys(hist).filter(k=>k.startsWith(calYear+'-'+String(calMonth+1).padStart(2,'0'))).sort();
  sorted.forEach(k=>{if(hist[k])cur++;else cur=0;streak=Math.max(streak,cur);});
  document.getElementById('csSm').textContent=avg||'--';
  document.getElementById('csStr').textContent=streak||'0';
  document.getElementById('csBil').textContent=monthData.length;
  document.getElementById('csDis').textContent=scores.length?Math.round(scores.filter(s=>s>=60).length/scores.length*100)+'%':'--';
  // Graphe 30j
  const bars=[];for(let i=29;i>=0;i--){const d=new Date();d.setDate(d.getDate()-i);const k=d.toISOString().split('T')[0];bars.push(hist[k]?.score_regerent||0);}
  document.getElementById('calProg').innerHTML=bars.map(s=>{
    const c=s>=80?'var(--vert)':s>=60?'var(--or)':s>0?'var(--rouge)':'var(--g3)';
    const h=s>0?Math.round(s*.6)+4:3;
    return`<div class="wb-w"><div class="wb" style="height:${h}px;background:${c}"></div></div>`;
  }).join('');
}
function calNav(dir){
  calMonth+=dir;if(calMonth>11){calMonth=0;calYear++;}if(calMonth<0){calMonth=11;calYear--;}
  renderCal();
}
function showDayDetail(ds){
  const hist=getDemoHistory();
  const data=hist[ds];
  const months=['Janvier','FÃ©vrier','Mars','Avril','Mai','Juin','Juillet','AoÃ»t','Septembre','Octobre','Novembre','DÃ©cembre'];
  const d=new Date(ds);
  document.getElementById('ddDate').textContent=d.getDate()+' '+months[d.getMonth()]+' '+d.getFullYear();
  if(data){
    const s=data.score_regerent,c=data.couleur_score||'jaune';
    const col=c==='vert'?'var(--vert)':c==='rouge'?'var(--rouge)':'var(--or)';
    document.getElementById('ddScore').textContent=s;document.getElementById('ddScore').style.color=col;
    const pillCls=c==='vert'?'p-vt':c==='rouge'?'p-rg':'p-or';
    const verb=c==='vert'?'PrÃªt. Forme optimale.':c==='rouge'?'RÃ©cupÃ©ration nÃ©cessaire.':'IntensitÃ© modÃ©rÃ©e.';
    document.getElementById('ddPill').innerHTML=`<div class="pill ${pillCls}">${c.toUpperCase()}</div>`;
    document.getElementById('ddVerb').textContent=verb;
    const zd=(data.zones_douleur||[]).filter(z=>z!='Aucune');
    const eu=(data.equipements_utilises||[]).filter(e=>e!='rien');
    document.getElementById('ddStats').innerHTML=`
      <div class="dd-stat"><span class="dd-stat-l">Sommeil</span><span class="dd-stat-r">${data.heures_sommeil||'--'}h</span></div>
      <div class="dd-stat"><span class="dd-stat-l">HRV simulÃ©</span><span class="dd-stat-r">${data.hrv_simule||'--'}</span></div>
      <div class="dd-stat"><span class="dd-stat-l">Ressenti physique</span><span class="dd-stat-r">${data.ressenti_physique||'--'}/10</span></div>
      <div class="dd-stat"><span class="dd-stat-l">Ressenti mental</span><span class="dd-stat-r">${data.ressenti_mental||'--'}/10</span></div>
      <div class="dd-stat"><span class="dd-stat-l">Douleurs</span><span class="dd-stat-r">${zd.length?zd.join(', '):'Aucune'}</span></div>
      <div class="dd-stat"><span class="dd-stat-l">Ã‰quipements</span><span class="dd-stat-r">${eu.length?eu.join(', '):'Rien'}</span></div>
      ${data.alerte?`<div class="dd-stat"><span class="dd-stat-l" style="color:var(--rouge)">âš ï¸ Alerte</span><span class="dd-stat-r" style="color:#FF8A80;font-size:10px">${data.alerte_message}</span></div>`:''}
    `;
  }else{
    document.getElementById('ddScore').textContent='--';document.getElementById('ddScore').style.color='var(--txt)';
    document.getElementById('ddPill').innerHTML='';document.getElementById('ddVerb').textContent='Aucun bilan ce jour';
    document.getElementById('ddStats').innerHTML='<div style="padding:16px;text-align:center;color:var(--txt);font-size:11px">Pas de donnÃ©es pour cette journÃ©e</div>';
  }
  document.getElementById('ddOverlay').classList.add('show');
}
function closeDd(e){if(e.target===document.getElementById('ddOverlay'))document.getElementById('ddOverlay').classList.remove('show');}

// ===== SÃ‰ANCE =====
const fPl=[{n:'K. Diallo',i:'KD',fc:142},{n:'M. TraorÃ©',i:'MT',fc:168},{n:'A. BaldÃ©',i:'AB',fc:125},{n:'S. Mara',i:'SM',fc:188},{n:'L. Dubois',i:'LD',fc:155},{n:'Y. Benzara',i:'YB',fc:201}];
function toggleSeance(){
  seanceOn=!seanceOn;
  const tr=document.getElementById('togTr');
  if(seanceOn){
    tr.classList.add('on');
    document.getElementById('sPill').textContent='EN SÃ‰ANCE';document.getElementById('sPill').className='pill p-rg';
    document.getElementById('togT').textContent='SÃ©ance en cours';document.getElementById('togS').textContent='Tap pour terminer';
    document.getElementById('hs').style.display='none';document.getElementById('es').style.display='block';
    seanceSec=0;seanceItv=setInterval(()=>{seanceSec++;updSeance();},1000);renderPl();
  }else{
    tr.classList.remove('on');
    document.getElementById('sPill').textContent='HORS SÃ‰ANCE';document.getElementById('sPill').className='pill p-or';
    document.getElementById('togT').textContent='Activer le mode sÃ©ance';document.getElementById('togS').textContent='Surveillance temps rÃ©el';
    document.getElementById('hs').style.display='block';document.getElementById('es').style.display='none';
    clearInterval(seanceItv);toast('SÃ©ance terminÃ©e â€” donnÃ©es sauvegardÃ©es');
  }
}
function updSeance(){
  const m=String(Math.floor(seanceSec/60)).padStart(2,'0'),s=String(seanceSec%60).padStart(2,'0');
  document.getElementById('sTimer').textContent=m+':'+s;
  fPl.forEach(p=>{p.fc=Math.max(100,Math.min(210,p.fc+Math.round((Math.random()-.47)*4)));});
  const avg=Math.round(fPl.reduce((a,p)=>a+p.fc,0)/fPl.length);
  document.getElementById('fcG').textContent=avg;
  document.getElementById('zBar').style.width=Math.min(100,Math.max(10,Math.round((avg-100)/110*100)))+'%';
  document.getElementById('zLbl').textContent=avg<140?'Zone 2':avg<165?'Zone 3 ModÃ©rÃ©':avg<185?'Zone 4 Intense':'Zone 5 MAX';
  if(seanceSec%5===0)renderPl();
  const al=fPl.filter(p=>p.fc>195);
  document.getElementById('sAlts').innerHTML=al.length?al.map(p=>`<div class="alrt-card"><div class="alrt-ic">â—</div><div><div class="alrt-t">${p.n} â€” ${p.fc} bpm</div><div class="alrt-d">Zone 5 maximale prolongÃ©e. Envisager une pause.</div></div></div>`).join(''):'<div style="text-align:center;padding:12px;color:var(--txt);font-size:10px">Tous les joueurs dans les zones normales âœ“</div>';
}
function renderPl(){
  const el=document.getElementById('plLive');
  el.innerHTML=fPl.slice().sort((a,b)=>b.fc-a.fc).map(p=>{
    const c=p.fc<140?'var(--vert)':p.fc<175?'var(--jaune)':'var(--rouge)';
    const bg=p.fc<140?'rgba(0,230,118,.08)':p.fc<175?'rgba(255,179,0,.08)':'rgba(255,61,61,.08)';
    const z=p.fc<140?'Zone 1-2':p.fc<175?'Zone 3':'Zone 4-5';
    return`<div class="pl-row"><div class="pl-av" style="background:${bg};color:${c}">${p.i}</div><div style="flex:1"><div style="font-size:12px;font-weight:600">${p.n}</div><div style="font-size:9px;color:var(--txt2)">${z}</div></div><div class="pl-fc" style="color:${c}">${p.fc}</div><div style="font-size:8px;color:var(--txt);margin-left:2px">bpm</div></div>`;
  }).join('');
}

// ===== CORPS =====
function buildCorps(){
  const zones=[{n:'Ischio G',r:'rouge'},{n:'Ischio D',r:'jaune'},{n:'Genou G',r:'jaune'},{n:'Genou D',r:'vert'},{n:'Cheville G',r:'vert'},{n:'Cheville D',r:'vert'},{n:'Dos',r:'jaune'},{n:'Ã‰paules',r:'vert'},{n:'Cuisse G',r:'vert'},{n:'Cuisse D',r:'rouge'}];
  const dc={rouge:'rgba(255,61,61,.12)',jaune:'rgba(255,179,0,.12)',vert:'rgba(0,230,118,.12)'};
  const cc={rouge:'var(--rouge)',jaune:'var(--jaune)',vert:'var(--vert)'};
  document.getElementById('bzGrid').innerHTML=zones.map(z=>`<div class="bz" style="background:${dc[z.r]};color:${cc[z.r]}"><div class="bz-dot" style="background:${cc[z.r]}"></div>${z.n}</div>`).join('');
  // Benchmarks
  const bks=[{l:'Score REGERENT moyen',p:82,d:'Top 18% des ailiers de National',c:'var(--vert)'},{l:'HRV moyen',p:74,d:'Top 22% Â· Position positive',c:'var(--vert)'},{l:'DisponibilitÃ© saison',p:94,d:'Top 12% Â· TrÃ¨s fiable',c:'var(--vert)'},{l:'Temps rÃ©cup post-match',p:68,d:'Meilleur que 71% des ailiers',c:'var(--or)'},{l:'Vitesse max sÃ©ance',p:55,d:'Top 35% Â· En progression',c:'var(--or)'}];
  document.getElementById('bkList').innerHTML=bks.map(b=>`<div class="bk-item"><div class="bk-top"><span class="bk-lbl">${b.l}</span><span class="bk-pct" style="color:${b.c}">${b.p}%</span></div><div class="bk-bar"><div class="bk-fill" style="width:${b.p}%;background:${b.c}"></div></div><div class="bk-desc">${b.d}</div></div>`).join('');
  // Classement Ã©quipe
  const ranks=[{n:'Kofi Diallo',sb:'Ailier D Â· Toi',sc:78,c:'var(--or)'},{n:'Marc TraorÃ©',sb:'Milieu Â· #2',sc:82,c:'var(--vert)'},{n:'Abdou BaldÃ©',sb:'DÃ©fenseur Â· #3',sc:75,c:'var(--or)'},{n:'Louis Dubois',sb:'Attaquant Â· #4',sc:67,c:'var(--jaune)'},{n:'Yann Benzara',sb:'Milieu Â· #5',sc:58,c:'var(--rouge)'}];
  document.getElementById('rankList').innerHTML=ranks.map((r,i)=>`<div class="rank-card"><div class="rank-num" style="color:${i===0?'var(--or)':'var(--txt)'}">${i+1}</div><div class="rank-info"><div class="rank-nm">${r.n}</div><div class="rank-sb">${r.sb}</div></div><div class="rank-sc" style="color:${r.c}">${r.sc}</div></div>`).join('');
}
function ct(i,el){
  document.querySelectorAll('.htab').forEach(t=>t.classList.remove('on'));el.classList.add('on');
  ['cb0','cb1','cb2','cb3'].forEach((id,j)=>document.getElementById(id).style.display=j===i?'block':'none');
}
async function addInj(){
  const type=prompt('Type de blessure :');if(!type)return;
  const zone=prompt('Zone corporelle :');if(!zone)return;
  const date=prompt('Date (AAAA-MM-JJ) :',new Date().toISOString().split('T')[0]);if(!date)return;
  const duree=prompt('DurÃ©e (jours) :');
  const avecR=confirm('Avec REGERENT ?');const rechute=confirm('Rechute ?');
  if(uid){await dbPost('blessures',{joueur_id:uid,type,zone_corporelle:zone,date_blessure:date,duree_recuperation:duree?parseInt(duree):null,avec_regerent:avecR,rechute}).catch(()=>{});}
  toast('Blessure ajoutÃ©e');
}

// ===== COACH IA =====
const rIA={
  hrv:['Le HRV est le meilleur signal de ton systÃ¨me nerveux autonome. Pour l\'augmenter : sommeil rÃ©gulier avant minuit, OXY ONE 3x/semaine, stress rÃ©duit. Sur 30 jours avec le protocole REGERENT, on vise +15 points en moyenne.','HRV bas ? RÃ©ponse normale aprÃ¨s charge intense ou mauvaise nuit. PrioritÃ© : OXY ONE ce soir, PRESSO ONE pour la circulation, et 8h30 de sommeil. Ã‰vite la cafÃ©ine aprÃ¨s 14h.'],
  match:['Protocole prÃ©-match REGERENT : J-2 sÃ©ance lÃ©gÃ¨re + OXY ONE 90 min. J-1 repos actif + PRESSO ONE soir + coucher avant 22h. Matin du match : petit-dÃ©j 3h avant, pas de CRYO dans les 4h prÃ©-match.','Readiness optimal = score REGERENT 80+. En dessous de 65, informe le staff. Ton corps ne ment jamais â€” Ã©coute-le.'],
  score:['Ton score combine : sommeil 35% + physique 25% + mental 20% + douleur 10% + Ã©quipements 10%. Le levier le plus puissant : 30 min de sommeil en plus = +8 points en moyenne.','Score bas ce matin ? 3 actions immÃ©diates : 1) OXY ONE ce soir 90 min, 2) coucher 22h30 max, 3) rÃ©duire charge sÃ©ance demain.'],
  ischio:['Ischios = zone critique footballeur. PrÃ©vention : Ã©chauffement nordique obligatoire, CRYO ONE ciblÃ© aprÃ¨s chaque sÃ©ance intensive, et surveillance charge hebdomadaire. Le BAND dÃ©tecte les patterns de fatigue avant la blessure.','Douleur ischio signalÃ©e. Protocole REGERENT : CRYO ONE 20 min aprÃ¨s chaque sÃ©ance, renforcement excentrique, et zÃ©ro match si score < 55.'],
  passeport:['Ton Passeport REGERENT est ton CV physique. Il certifie ta disponibilitÃ©, tes temps de rÃ©cupÃ©ration et ton Ã©volution. Les clubs l\'achÃ¨tent avant un transfert pour avoir une preuve objective de ta fiabilitÃ©. Plus tu utilises REGERENT rÃ©guliÃ¨rement, plus ton passeport a de valeur.','Le passeport inclut : disponibilitÃ© sur 6-24 mois, score moyen, Ã©volution HRV, historique blessures, discipline rÃ©cupÃ©ration. C\'est l\'argument que ton agent utilise pour nÃ©gocier.'],
  def:['Bonne question. Continue sur cette voie et utilise le protocole REGERENT recommandÃ© ce soir pour optimiser ta rÃ©cupÃ©ration.','En tant que footballeur professionnel, chaque dÃ©tail compte. Tes donnÃ©es REGERENT montrent des axes d\'amÃ©lioration clairs. Parle aussi avec ton staff.']
};
function getCR(m){const ml=m.toLowerCase();if(ml.includes('hrv'))return rIA.hrv[Math.random()>.5?1:0];if(ml.includes('match')||ml.includes('compÃ©t'))return rIA.match[Math.random()>.5?1:0];if(ml.includes('score')||ml.includes('bas'))return rIA.score[Math.random()>.5?1:0];if(ml.includes('ischio')||ml.includes('blessure'))return rIA.ischio[Math.random()>.5?1:0];if(ml.includes('passeport'))return rIA.passeport[Math.random()>.5?1:0];return rIA.def[Math.random()>.5?1:0];}
function sendC(){
  const inp=document.getElementById('cInp'),msg=inp.value.trim();if(!msg)return;inp.value='';
  const w=document.getElementById('cMsgs');
  w.innerHTML+=`<div class="c-msg c-usr">${msg}</div>`;
  w.innerHTML+=`<div class="c-typing" id="cTyp"><div class="c-dot"></div><div class="c-dot"></div><div class="c-dot"></div></div>`;
  w.scrollTop=w.scrollHeight;
  setTimeout(()=>{
    document.getElementById('cTyp')?.remove();
    w.innerHTML+=`<div class="c-msg c-ai">${getCR(msg)}</div>`;
    w.scrollTop=w.scrollHeight;
  },1400);
}
function askC(q){document.getElementById('cInp').value=q;sendC();}

// ===== MARKETPLACE =====
function buildMarket(){
  const rec=[{i:'ğŸ”«',n:'Pistolet massage',br:'Theragun OEM',p:'89â‚¬',r:'RecommandÃ© Â· Zone ischio fragile'},{i:'ğŸ§¦',n:'Chaussettes compression',br:'REGERENT x 2xu',p:'34â‚¬',r:'RecommandÃ© Â· RÃ©cupÃ©ration veineuse'}];
  const eq=[{i:'ğŸ‘Ÿ',n:'Crampons terrain souple',br:'New Balance',p:'129â‚¬',r:''},{i:'ğŸ›¡ï¸',n:'ProtÃ¨ge-tibias carbone',br:'Nike',p:'49â‚¬',r:''},{i:'âŒš',n:'REGERENT BAND',br:'Hardware officiel',p:'149â‚¬',r:'Essentiel pour ton score'}];
  const nut=[{i:'ğŸ¥¤',n:'ProtÃ©ines rÃ©cupÃ©ration',br:'REGERENT Nutrition',p:'39â‚¬',r:'Post-sÃ©ance optimal'},{i:'ğŸ’Š',n:'MagnÃ©sium + OmÃ©ga-3',br:'Nutri Sport',p:'28â‚¬',r:'Sommeil + inflammation'}];
  const mk=s=>s.map(p=>`<div class="mkt-card"><div class="mkt-ic">${p.i}</div><div class="mkt-nm">${p.n}</div><div class="mkt-br">${p.br}</div><div class="mkt-p">${p.p}</div>${p.r?`<div class="mkt-rec">âœ“ ${p.r}</div>`:''}<button class="mkt-btn" onclick="toast('Redirection vers la boutique...')">COMMANDER â†’</button></div>`).join('');
  document.getElementById('mktRec').innerHTML=mk(rec);
  document.getElementById('mktEq').innerHTML=mk(eq);
  document.getElementById('mktNut').innerHTML=mk(nut);
}

// ===== PROFIL =====
function buildProfil(){
  if(!profile)return;
  document.getElementById('pAv').textContent=(profile.prenom[0]+profile.nom[0]).toUpperCase();
  document.getElementById('pNm').textContent=profile.prenom+' '+profile.nom;
  document.getElementById('pSb').textContent=[profile.position,profile.club].filter(Boolean).join(' Â· ');
}

// ===== AGENT =====
const demoJoueurs=[
  {n:'Pape Matar Sarr',sb:'Milieu Â· Tottenham',sc:84,c:'var(--vert)',id:'#RG-0042-FR'},
  {n:'Sekou Mara',sb:'Attaquant Â· Southampton',sc:71,c:'var(--or)',id:'#RG-0087-FR'},
  {n:'Mamadou Diallo',sb:'DÃ©fenseur Â· Reims',sc:65,c:'var(--jaune)',id:'#RG-0156-FR'},
  {n:'Ibrahim KonÃ©',sb:'Milieu Â· Lens',sc:78,c:'var(--or)',id:'#RG-0203-FR'},
];
const demoRapports=[
  {j:'Pape Matar Sarr',club:'Arsenal FC',type:'PRO',prix:'199â‚¬',date:'12 Jan 2026',st:'LivrÃ©'},
  {j:'Sekou Mara',club:'Brighton',type:'BASIC',prix:'99â‚¬',date:'8 FÃ©v 2026',st:'En attente'},
];
let prixSel=0;
function buildAgent(){
  document.getElementById('agJoueurs').innerHTML=demoJoueurs.map(j=>`<div class="jou-card"><div class="jou-av" style="background:rgba(201,168,76,.08);color:var(--or)">${j.n.split(' ').map(w=>w[0]).join('')}</div><div class="jou-info"><div class="jou-nm">${j.n}</div><div class="jou-sb">${j.sb} Â· ${j.id}</div></div><div class="jou-sc" style="color:${j.c}">${j.sc}</div></div>`).join('');
  document.getElementById('agRapports').innerHTML=demoRapports.map(r=>`<div class="card" style="padding:12px;margin-bottom:7px"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px"><div style="font-weight:600;font-size:12px">${r.j}</div><div class="pill ${r.st==='LivrÃ©'?'p-vt':'p-or'}">${r.st}</div></div><div style="display:flex;gap:12px;font-size:10px;color:var(--txt2)"><span>ğŸŸï¸ ${r.club}</span><span>ğŸ“‹ ${r.type}</span><span>ğŸ’¶ ${r.prix}</span><span>ğŸ“… ${r.date}</span></div></div>`).join('');
}
function selPrix(i,el){prixSel=i;document.querySelectorAll('.prix-card').forEach(c=>c.classList.remove('on'));el.classList.add('on');}
function genRapport(){
  const types=['BASIC 99â‚¬ Â· 6 mois','PRO 199â‚¬ Â· 12 mois','ELITE 499â‚¬ Â· 24 mois'];
  toast('Lien de paiement gÃ©nÃ©rÃ© Â· '+types[prixSel]);
}

// ===== STAFF =====
const demoTeam=[
  {n:'K. Diallo',i:'KD',sc:78,c:'var(--or)'},{n:'M. TraorÃ©',i:'MT',sc:82,c:'var(--vert)'},{n:'A. BaldÃ©',i:'AB',sc:75,c:'var(--or)'},
  {n:'S. Mara',i:'SM',sc:88,c:'var(--vert)'},{n:'L. Dubois',i:'LD',sc:55,c:'var(--rouge)'},{n:'Y. Benzara',i:'YB',sc:62,c:'var(--jaune)'},
  {n:'P. Martin',i:'PM',sc:79,c:'var(--or)'},{n:'C. Lopez',i:'CL',sc:91,c:'var(--vert)'},{n:'R. TourÃ©',i:'RT',sc:48,c:'var(--rouge)'},
  {n:'F. Nguyen',i:'FN',sc:73,c:'var(--or)'},{n:'B. Sarr',i:'BS',sc:85,c:'var(--vert)'},{n:'A. CissÃ©',i:'AC',sc:67,c:'var(--jaune)'},
];
function buildStaff(){
  document.getElementById('stTeam').innerHTML=demoTeam.map(p=>{
    const bg=p.sc>=80?'rgba(0,230,118,.08)':p.sc>=60?'rgba(255,179,0,.08)':'rgba(255,61,61,.08)';
    return`<div class="tg-card" style="background:${bg}"><div class="tg-av" style="background:rgba(255,255,255,.05);color:${p.c}">${p.i}</div><div class="tg-nm">${p.n}</div><div class="tg-sc" style="color:${p.c}">${p.sc}</div></div>`;
  }).join('');
  document.getElementById('stAlerts').innerHTML=[
    {n:'Romain TourÃ©',sc:48,msg:'Score 48 Â· 2Ã¨me jour consÃ©cutif. Charge Ã  rÃ©duire impÃ©rativement.'},
    {n:'Louis Dubois',sc:55,msg:'Score 55 + douleur ischio signalÃ©e. Surveiller avant sÃ©ance.'},
  ].map(a=>`<div class="alrt-card"><div class="alrt-ic">âš ï¸</div><div><div class="alrt-t">${a.n} â€” Score ${a.sc}</div><div class="alrt-d">${a.msg}</div></div></div>`).join('');
  const bars=[45,62,71,55,78,82,0];
  document.getElementById('stBars').innerHTML=bars.map(s=>{
    const c=s>=80?'var(--vert)':s>=60?'var(--or)':s>0?'var(--rouge)':'var(--g3)';
    const h=s>0?Math.round(s*.5)+4:3;
    return`<div class="wb-w"><div style="font-size:8px;font-weight:600;color:${s>0?c:'var(--g5)'};margin-bottom:2px">${s||''}</div><div class="wb" style="height:${h}px;background:${c}"></div></div>`;
  }).join('');
}
function buildStaffCal(){
  renderStaffCal();
}
function renderStaffCal(){
  const months=['JANVIER','FÃ‰VRIER','MARS','AVRIL','MAI','JUIN','JUILLET','AOÃ›T','SEPTEMBRE','OCTOBRE','NOVEMBRE','DÃ‰CEMBRE'];
  document.getElementById('calStaffTitle').textContent=months[calStaffMonth]+' '+calStaffYear;
  const first=new Date(calStaffYear,calStaffMonth,1);
  let dow=first.getDay()-1;if(dow<0)dow=6;
  const days=new Date(calStaffYear,calStaffMonth+1,0).getDate();
  const today=new Date();
  const matchDays=[5,12,19,26];
  let html='';
  for(let i=0;i<dow;i++)html+='<div class="cal-day empty"></div>';
  for(let d=1;d<=days;d++){
    const isToday=today.getFullYear()===calStaffYear&&today.getMonth()===calStaffMonth&&today.getDate()===d;
    const isMatch=matchDays.includes(d);
    const isFuture=new Date(calStaffYear,calStaffMonth,d)>today;
    let bg,color='color:var(--blanc)';
    if(isMatch){bg='background:rgba(41,121,255,.25)';}
    else if(isFuture){bg='background:transparent';color='color:var(--g5)';}
    else{const rnd=Math.random();bg=rnd>.6?'background:rgba(0,230,118,.2)':rnd>.3?'background:rgba(255,179,0,.2)':'background:rgba(255,61,61,.2)';}
    html+=`<div class="cal-day" style="${bg};${color} ${isToday?';border:1px solid var(--or)':''}">${d}${isMatch?'<div class="day-dot" style="background:var(--bleu)"></div>':''}</div>`;
  }
  document.getElementById('calStaffGrid').innerHTML=html;
}
function calStaffNav(dir){
  calStaffMonth+=dir;if(calStaffMonth>11){calStaffMonth=0;calStaffYear++;}if(calStaffMonth<0){calStaffMonth=11;calStaffYear--;}
  renderStaffCal();
}

// ===== NAV =====
const navMap={
  joueur:{'s-home':'n-home','s-bilan':'n-bilan','s-cal':'n-cal','s-seance':'n-seance','s-corps':'n-corps','s-coach':'n-coach','s-market':'n-market','s-profil':'n-profil'},
  agent:{'s-agent':'na-port','s-coach':'na-coach'},
  staff:{'s-staff':'ns-home','s-staffcal':'ns-cal','s-seance':'ns-seance','s-coach':'ns-coach'}
};
function goTo(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id)?.classList.add('active');
  const mode=profile?.role||curMode;
  const map=navMap[mode]||navMap.joueur;
  document.querySelectorAll('.nt').forEach(t=>t.classList.remove('on'));
  const k=map[id];if(k)document.getElementById(k)?.classList.add('on');
  document.querySelector('#'+id+' .scroll')?.scrollTo(0,0);
}

// ===== TOAST =====
function toast(msg,dur=3000){const t=document.getElementById('toast');t.textContent=msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),dur);}

// ===== START =====
init();
</script>

</body>
</html>
